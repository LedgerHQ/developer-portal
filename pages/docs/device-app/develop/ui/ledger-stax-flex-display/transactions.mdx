---
title: Signing transactions and messages
description: Signing transactions is the core function of Ledgerâ€™s hardware wallets, and itâ€™s a core function of your app. This section presents the fundamentals of transactions and the user experience that is expected for clear signing.
---

import { Callout } from 'nextra/components'

# Signing transactions and messages

Signing transactions is the core function of Ledgerâ€™s hardware wallets, and probably a core function of your app too.

This chapter presents the expected user experience of clear signing, as well as the required UI elements to use when blind signing.

## Definitions

### Transactions, messages, and operations

Throughout the Ledger documentation, youâ€™ll find references to signing â€œtransactionsâ€ and â€œmessagesâ€. They are defined as:
- a transaction affects the state of a blockchain, like sending Bitcoin or transferring an NFT on Polygon;
- a message is an off-chain payload that is signed and then either broadcasted later, bundled with another operation, or used for off-chain verification. This is typically encountered on EVM chains (e.g. EIP-191, EIP-712 such as permits, etc.).
- an operation is a generic term that can describe a transaction or a message, and can be used as a generic fallback.

### Clear signing and blind signing

â€œClear signingâ€ transactions means that users fully understand what theyâ€™re signing. The transaction parameters must be presented in a complete and easy-to-understand way, so that the userâ€™s consent is fully informed.

Thanks to the Secure Display of their Ledger device and Ledgerâ€™s cryptographic infrastructure, users have the guarantee that what they see is what they sign.

While this doesnâ€™t always guarantee execution (which would require full smart contract audits, and more), clear signing is a must-have for security because it protects users against malware and man-in-the-middle attacks.

User experience greatly benefits from clear signing too, as only the relevant fields to review are presented (conciseness) and they are well formatted (clarity and protection from mistakes).

Because clear signing is crucial for security and user-friendliness, blind- signed transactions and messages must display a standard warning that asks for explicit user acknowledgement. This will be presented later in this section.


## Anatomy of a transaction

All transactions and messages must respect the following structure:

![Transaction Structure](/device-app/stax-flex-transaction-structure.jpg)

The double-sided arrows represent the ability for users to navigate back and forth within the operation. Navigation edge-cases are discussed in the later chapter â€œAdvanced interactionsâ€.

Hereâ€™s an illustration of this structure with the Bitcoin app on Ledger Flex: 

![Transaction Structure](/device-app/stax-flex-bitcoin-structure.jpg)

<Callout type="warning" emoji="âš ï¸">
  Users should be able to reject the operation at any time, if they see information they were not expecting. This can happen at every step, including the intent and signature.
	Do not change the default UI elements that display the â€œRejectâ€ or â€œCancelâ€ buttons at the bottom of each step of the transaction.
</Callout>

In the next sections, weâ€™ll go step by step over the different parts of a canonical transaction.

<Callout emoji="ğŸ’»">
	<b>API</b><br/>
  	<code>nbgl_useCaseReview()</code><br/>
  	This high-level API function covers the full standard transaction layout presented in this chapter. <a href="https://ledgerhq.github.io/ledger-secure-sdk/nbgl__use__case_8h.html#a303e3242b26535f74695f94a51d8cb6a">View API docs</a>.
</Callout>

## Loading transaction data

**Most transactions and messages should feel instantaneous to load for users.**

Sometimes though, the processing or data fetching durations might be noticeable. In these cases, use the standard loaders for Ledger Stax and Ledger Flex. As a rule of thumb, you can present the loader if the loading duration is 1 second or greater. Avoid showing the loader for only a few milliseconds, as the flashing may appear as a bug to users.

![Loading transaction](/device-app/stax-flex-loading.jpg)


## Intent: giving context and information to users

The transaction intent is the first page displayed to users. It is part of clear signing and shows crucial information
- the nature of the operation: transaction or message;
- the chain(s) or network(s) involved;
- the type of the operation: send, swap, delegate, approve, list NFT, etc. ;
- and any other useful information before getting into the detailed review of the fields.

The intent acts both as an informational step and a safety net, because users can reject the operation as soon as the prompt is displayed, without even reviewing the fields.

<Callout type="info" emoji="â„¹ï¸">
	When the intent appears, Ledger Stax and Ledger Flex play a sound to attracting the userâ€™s attention to the device, where theyâ€™ll take action next. Keep this default behavior in your app unless you have a reason not to. And remember that users can disable sounds in the device settings.
</Callout>

Here are intent examples for different apps and operations.

![Intent examples](/device-app/stax-flex-intent-example-01.jpg)

Here are more intent examples from other chains:

![Intent examples](/device-app/stax-flex-intent-example-02.jpg)

When lacking information about the transaction or message, use a generic intent as a fallback:

![Generic intant](/device-app/stax-flex-generic-intant.jpg)

<Callout type="warning" emoji="âš ï¸">
	Avoid falling back to generic intents as much as possible, and always favor more information and context so that users clear sign with confidence, or reject if anything is different from what they expected.
</Callout>

<Callout type="info" emoji="â„¹ï¸">
	The prompt sentence must start with â€œReviewâ€. It is built either:
	<ul>
		<li>dynamically, composing the transaction type and other key informations;</li>
		<li>or statically, by making a legible sentence with the available information for every transaction type.</li>
	</ul>
</Callout>

## Presenting transaction fields for review

Transaction fields must allow users to fully understand the operation theyâ€™re signing, while minimizing info that is not useful to their control or safety.

Transaction or message fields are always structured in the same way: rows of key-value pairs. You donâ€™t have to do any UI work here, as the default layout will automatically take care of page construction and pagination.

![Layout differences](/device-app/stax-flex-layout-differences.jpg)

Ensure consistency by presenting common fields in a consistent order. For simple transfers, this ish
1. â€œFromâ€ address
2. â€œAmountâ€ (value and currency)
3. â€œToâ€ addresOs
4. â€œFeesâ€ (value and currency).
Hereâ€™s how the Ethereum app displays a transfer by following this guideline: 


![Ethereum transaction](/device-app/stax-flex-ethereum-transaction.jpg)

<Callout type="warning" emoji="âš ï¸">
	<ul>
		<li>Let your users navigate back and forth within transactions. Exceptions, such as streamed transactions, are discussed in a later chapter.</li>
		<li> Pagination is automatically handled by the API, so you can just focus on providing your users with the right fields</li>
		<li>Field names must be consistent and explicit. For example, use the term â€œToâ€ over the generic â€œAddressâ€ to distinguish sender and receiver. Use â€œAmountâ€ and â€œFeesâ€ (or â€œMax feesâ€) consistently.</li>
	</ul>
</Callout>

## Signing a transaction

The signing page is always the last one because it ensures that your users went through all the critical fields they needed to review.

The signing page recalls the intent by presenting similar data, to bring up the context during signing.

Confirming a transaction always uses the same press-and-hold gesture on the dedicated area of the screen: â€œHold to signâ€. After 2 seconds, the transaction is signed and the user receives a success notification accompanied by a sound.

The notification dismisses automatically after a few seconds, and the user is back on your appâ€™s home screen.

![Bitcoin transfer](/device-app/stax-flex-bitcoin-transfer.jpg)
<br/>
![Permit 2 signing with the Ethereum App](/device-app/stax-flex-permit2-ethereum.jpg)

<Callout type="warning" emoji="âš ï¸">
	<ul>
		<li>Stick to the default â€œHold to signâ€ wording, as the Ledger device cannot know if the transaction was properly transmitted to the software wallet and broadcasted on the blockchain.</li>
		<li>Similarly, stick to the default â€œTransaction signedâ€ or â€œmessage signedâ€ wording, as the Ledger device cannot know if the transaction was successfully broadcasted.</li>
	</ul>
</Callout>

## Rejecting transaction

Rejecting a transaction is a safety action that must be accessible at all times. Thus, this action always sits at the bottom of every screen, from the transaction prompt to the signing step.

When users tap on â€œReject transactionâ€, a confirmation modal asks them to confirm. This is to prevent accidental touches.

![Rejecting a transaction](/device-app/stax-flex-rejecting-transaction.jpg)


## Page grouping

To help your users navigate longer or more complex transactions, you might want to group several field pages into sections. You can achieve this by using divider pages, that simply show a section title and a section number:

![Page grouping](/device-app/stax-flex-page-grouping.jpg)

## Blind signing

When a transaction cannot be fully decoded, a standard â€œblind signing warning sequenceâ€ must be presented to users. This sequence informs them about the risk theyâ€™re facing
- First, a generic warning message lets them â€œgo back to safetyâ€ as the primary action. Your app should not customize this screen and its wording, unless strictly necessary
- Then, a detailed explanation of the risk is presented to users, with redirections to learn more about it. Your app should customize this detailed view, as it is likely dependent on your specific use cases and networks
- On the transaction intent and signature pages, a warning icon is introduced. When tapped, it brings back the detailed risk review as a modal.

The example below shows a blind signing sequence on Ledger Stax, where the Ethereum app presents the approval of an unknown ERC-20 token.

![Stax Blind Signing](/device-app/stax-blind-signing.jpg)

Hereâ€™s the exact same sequence on Ledger Flex, for a comprehensive overview of this warning mechanism:
![Flex Blind Signing](/device-app/flex-blind-signing.jpg)

<Callout emoji="ğŸ’»">
	<b>API</b><br/>
	<code>nbgl_useCaseChoice()</code><br/>
	<code>nbgl_useCaseChoice()</code><br/>
	<code>nbgl_useCaseReview(with BLIND_OPERATION flag)</code><br/>
	These high-level API functions allow you to manually set the two warning screens preceding the transaction review, and enable the warning icon on the top right of Review transaction and Sign transaction pages. <a href="https://github.com/LedgerHQ/app-boilerplate/pull/127">View Boilerplate application PR example</a>.
</Callout>

## Signing messages

While this whole chapter mainly focused on transactions, the same principles apply to messages. The wording must reflect this change by consistently replacing â€œtransactionâ€ with â€œmessageâ€.

When messages lack information about their type, structure, blockchain, or network, the prompt and signature screens must use this â€œscrollâ€ icon:

![Review transaction](/device-app/stax-flex-review-transaction.jpg)

## Key takeaways

<Callout>
	<ul>
		<li>Rely on the default transaction structure and allow users to navigate freely within it. Use the default signing gesture and wording to make the experience consistent across all apps</li>
		<li>Leverage the transaction intent and the transaction fields to craft a great clear signing experience for your specific use cases, balancing complete user control with digestible information.</li>
		<li>When clear signing is not possible, you must use the standard â€œBlind signingâ€ warning template.</li>
		<li>Refer to the â€œAdvanced interactionsâ€ chapter if your app needs to handle special cases outside the high-level API â€œuse caseâ€ functions.</li>
	</ul>
</Callout>




