<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Embedded SDK: Complex objects layout API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Embedded SDK
   </div>
   <div id="projectbrief">Embedded SDK</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">Embedded SDK</a></li><li class="navelem"><a class="el" href="nbgl_mainpage.html">New BOLOS Graphic API for Stax/Flex</a></li>  </ul>
</div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Complex objects layout API </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="nbgl_layout_intro"></a>
Introduction</h1>
<p>This chapter describes briefly the mid level API of Advanced BOLOS Graphic Library.</p>
<p>This layer offers a simplified view of a screen page, using complex (aggregated) objects, like a radio buttons choice or touchable areas.</p>
<p>A full description of each functions/types can be found in this document</p>
<h1><a class="anchor" id="concepts2"></a>
Concepts</h1>
<p>This layer uses the low-level API described in <a class="el" href="nbgl_obj.html">Advanced BOLOS GL API</a>, but all graphic objects are hidden, in favor to abstract complex objects like a radio buttons choice or touchable areas.</p>
<p>Moreover, positions of objects in the page are mostly hidden and automatic.</p>
<h2><a class="anchor" id="example_1"></a>
Example 1</h2>
<p><img src="stax_layout1.png" alt="" height="300" class="inline" title="caption"/></p>
<p>In this example, 3 "objects" are used and added to the page with dedicated APIs:</p>
<ul>
<li>A top-right button with a customizable icon</li>
<li>A centered information area with an icon, a main text and possibly a subsidiary text under it.</li>
<li>A centered bottom button with a customizable icon</li>
</ul>
<h2><a class="anchor" id="example_2"></a>
Example 2</h2>
<p><img src="stax_layout9.png" alt="" height="300" class="inline" title="caption"/></p>
<p>In this more complex example, a "tapable" container is used for the whole screen, except the footer area and the progress indicator.</p>
<p>In the "tapable" container, 2 objects are drawn, a single pair of tag/value, and a "more" button to execute an action.</p>
<h1><a class="anchor" id="operations"></a>
Common operations</h1>
<h2><a class="anchor" id="create_layout"></a>
Getting a new layout</h2>
<p>The first operation is always to get a new layout, with the desired parameters:</p>
<ul>
<li>An action callback used for all controls of the page</li>
<li>A text and token to be used for action callback if a potential "tapable" container is used in page</li>
<li>A boolean indicated whether the page is modal or not (first or second plane)</li>
<li>A potential ticker configuration if a ticker is required for the page</li>
</ul>
<p>The function to actually create the layout is <a class="el" href="nbgl__layout_8h.html#a9ff89401d84106e775567a11c40769b7">nbgl_layoutGet()</a></p>
<p>For example 1:</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structnbgl__layoutDescription__s.html">nbgl_layoutDescription_t</a> layoutDescription = {</div>
<div class="line">  .<a class="code hl_variable" href="structnbgl__layoutDescription__s.html#a0768b0863e64e44da3ebab04aca0ca6b">modal</a> = <span class="keyword">false</span>, <span class="comment">// not modal (so on plane 0)</span></div>
<div class="line">  .onActionCallback = &amp;myActionCallback, <span class="comment">// generic callback for all controls</span></div>
<div class="line">  .onTapText = NULL, <span class="comment">// no &quot;tapable&quot; main container</span></div>
<div class="line">  .ticker.callback = NULL <span class="comment">// no ticker</span></div>
<div class="line">};</div>
<div class="line"><span class="comment">// create layout</span></div>
<div class="line"><a class="code hl_typedef" href="nbgl__layout_8h.html#a8c06300795d2ce7f2a5c59b7c8fe4c01">nbgl_layout_t</a> *layout = <a class="code hl_function" href="nbgl__layout_8h.html#a9ff89401d84106e775567a11c40769b7">nbgl_layoutGet</a>(&amp;layoutDescription);</div>
<div class="ttc" id="anbgl__layout_8h_html_a8c06300795d2ce7f2a5c59b7c8fe4c01"><div class="ttname"><a href="nbgl__layout_8h.html#a8c06300795d2ce7f2a5c59b7c8fe4c01">nbgl_layout_t</a></div><div class="ttdeci">void * nbgl_layout_t</div><div class="ttdoc">type shared externally</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout_8h_source.html#l00096">nbgl_layout.h:96</a></div></div>
<div class="ttc" id="anbgl__layout_8h_html_a9ff89401d84106e775567a11c40769b7"><div class="ttname"><a href="nbgl__layout_8h.html#a9ff89401d84106e775567a11c40769b7">nbgl_layoutGet</a></div><div class="ttdeci">nbgl_layout_t * nbgl_layoutGet(const nbgl_layoutDescription_t *description)</div><div class="ttdoc">returns a layout of the given type. The layout is reset</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout_8c_source.html#l00995">nbgl_layout.c:995</a></div></div>
<div class="ttc" id="astructnbgl__layoutDescription__s_html"><div class="ttname"><a href="structnbgl__layoutDescription__s.html">nbgl_layoutDescription_s</a></div><div class="ttdoc">Structure containing all information when creating a layout. This structure must be passed as argumen...</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout_8h_source.html#l00171">nbgl_layout.h:171</a></div></div>
<div class="ttc" id="astructnbgl__layoutDescription__s_html_a0768b0863e64e44da3ebab04aca0ca6b"><div class="ttname"><a href="structnbgl__layoutDescription__s.html#a0768b0863e64e44da3ebab04aca0ca6b">nbgl_layoutDescription_s::modal</a></div><div class="ttdeci">bool modal</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout_8h_source.html#l00172">nbgl_layout.h:172</a></div></div>
</div><!-- fragment --><p>For example 2:</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structnbgl__layoutDescription__s.html">nbgl_layoutDescription_t</a> layoutDescription = {</div>
<div class="line">  .<a class="code hl_variable" href="structnbgl__layoutDescription__s.html#a0768b0863e64e44da3ebab04aca0ca6b">modal</a> = <span class="keyword">false</span>, <span class="comment">// not modal (so on plane 0)</span></div>
<div class="line">  .onActionCallback = &amp;myActionCallback, <span class="comment">// generic callback for all controls</span></div>
<div class="line">  .onTapText = <span class="stringliteral">&quot;Tap to continue&quot;</span>, <span class="comment">// A &quot;tapable&quot; main container is necessary, with this text</span></div>
<div class="line">  .onTapToken = TAP_TOKEN, <span class="comment">// token to be used when main container is touched</span></div>
<div class="line">  .ticker.callback = NULL <span class="comment">// no ticker</span></div>
<div class="line">};</div>
<div class="line"><span class="comment">/* create layout */</span></div>
<div class="line"><a class="code hl_typedef" href="nbgl__layout_8h.html#a8c06300795d2ce7f2a5c59b7c8fe4c01">nbgl_layout_t</a> *layout = <a class="code hl_function" href="nbgl__layout_8h.html#a9ff89401d84106e775567a11c40769b7">nbgl_layoutGet</a>(&amp;layoutDescription);</div>
</div><!-- fragment --><h2><a class="anchor" id="draw_layout"></a>
Drawing a populated layout</h2>
<p>Once defined and populated, all objects can be drawn in <b>framebuffer</b> with a simple call to <a class="el" href="nbgl__layout_8h.html#a6805bf1d2b7adab8d89fc9e67e3053f9">nbgl_layoutDraw()</a>.</p>
<h1><a class="anchor" id="add_objects"></a>
Populating a layout</h1>
<p>Once the layout is defined and retrieved with <a class="el" href="nbgl__layout_8h.html#a9ff89401d84106e775567a11c40769b7">nbgl_layoutGet()</a>, the page can be filled with complex objects.</p>
<p>If a "tapable" container is used, most objects will be added in it, except the ones on top (progress indicator or top-right button) or on bottom (navigation bar or bottom button). Otherwise objects are all added in the whole page.</p>
<h2><a class="anchor" id="top_right_button"></a>
Top-right button</h2>
<p><img src="stax_layout1.png" alt="" height="300" class="inline" title="caption"/></p>
<p>This object is made of a single round button, on top right of the screen.</p>
<p>The only properties of this object are</p>
<ul>
<li>The 32px/32px icon to use in it</li>
<li>A <b>token</b> used with the action callback when the button is touched</li>
</ul>
<p>The API to insert such an object is <a class="el" href="nbgl__layout_8h.html#a7bc9229ae12ae8df568d869e6b80e312">nbgl_layoutAddTopRightButton()</a></p>
<dl class="section warning"><dt>Warning</dt><dd>This object is incompatible with Progress indicator, for example</dd></dl>
<h2><a class="anchor" id="bottom_button"></a>
Bottom centered button</h2>
<p><img src="stax_layout1.png" alt="" height="300" class="inline" title="caption"/></p>
<p>This object is made of a single round button, on middle bottom of the screen.</p>
<p>The only properties of this object are:</p>
<ul>
<li>The 32px/32px icon to use in it</li>
<li>A <b>token</b> used with the action callback when the button is touched</li>
</ul>
<p>The API to insert such an object is <a class="el" href="nbgl__layout_8h.html#ad0200e32ed67aceaa85e77f579cf8332">nbgl_layoutAddBottomButton()</a>.</p>
<p>Optionally, a thin horizontal separation can be drawn on top of the button, if <b>separationLine</b> parameter of <a class="el" href="nbgl__layout_8h.html#ad0200e32ed67aceaa85e77f579cf8332">nbgl_layoutAddBottomButton()</a> is true.</p>
<dl class="section warning"><dt>Warning</dt><dd>This object is incompatible with navigation bar or footer, for example</dd></dl>
<h2><a class="anchor" id="footer"></a>
Footer section</h2>
<p><img src="layout3.png" alt="" height="300" class="inline" title="caption"/></p>
<p>This object acts as a full width text area at the bottom of the screen.</p>
<p>The only properties of this object are:</p>
<ul>
<li>The text to be drawn for the footer</li>
<li>A <b>token</b> used with the action callback when the footer is touched</li>
</ul>
<p>The API to insert such an object is <a class="el" href="nbgl__layout_8h.html#aee3869e504a174bc3d8e702c75517d80">nbgl_layoutAddFooter()</a>.</p>
<p>A thin horizontal separation is drawn on top of the text area.</p>
<dl class="section warning"><dt>Warning</dt><dd>This object is incompatible with navigation bar or bottom button, for example</dd></dl>
<h2><a class="anchor" id="split_footer"></a>
Split footer section</h2>
<p><img src="layout-SplitFooter.png" alt="" height="300" class="inline" title="caption"/></p>
<p>This object acts as a two horizontally adjacent touchable text areas at the bottom of the screen.</p>
<p>The properties of this object are:</p>
<ul>
<li>The text to be drawn on left part of footer</li>
<li>A <b>token</b> used with the action callback when the left part of footer is touched</li>
<li>The text to be drawn on right part of footer</li>
<li>A <b>token</b> used with the action callback when the right part of footer is touched</li>
</ul>
<p>The API to insert such an object is <a class="el" href="nbgl__layout_8h.html#a61173c72db158ff3d9a2cc556d276612">nbgl_layoutAddSplitFooter()</a>.</p>
<p>A thin horizontal separation is drawn on top of the text areas. A thin vertical separation is drawn between both text areas.</p>
<dl class="section warning"><dt>Warning</dt><dd>This object is incompatible with navigation bar or bottom button, for example</dd></dl>
<h2><a class="anchor" id="centered_info"></a>
Centered info area</h2>
<p><img src="stax_layout1.png" alt="" height="300" class="inline" title="caption"/></p>
<p>This object is made of:</p>
<ul>
<li>An optional icon</li>
<li>An optional main text under the icon</li>
<li>An optional sub text under the main text</li>
</ul>
<p>The whole object is centered horizontally in the page</p>
<p>It can be either centered vertically or put on top of the page.</p>
<p>The API to insert such an object is <a class="el" href="nbgl__layout_8h.html#a583c5227ac31ac8e334401c415d31a21">nbgl_layoutAddCenteredInfo()</a>, using <a class="el" href="nbgl__layout_8h.html#afd55ca421dc08955c6cf138014effc00">nbgl_layoutCenteredInfo_t</a> structure</p>
<p>The colors and fonts for the texts depends of the <b>style</b> field used in <a class="el" href="nbgl__layout_8h.html#afd55ca421dc08955c6cf138014effc00">nbgl_layoutCenteredInfo_t</a>.</p>
<ul>
<li>if <a class="el" href="nbgl__content_8h.html#a3735e557349f1945eff88ee65ea92fb5ac9ca6f5b18aa4307bf63f7f295110f50">LARGE_CASE_INFO</a>, main text is in <a class="el" href="nbgl__types_8h.html#a0a8ef1b5e1941b7257e545cc33405ff1af77fb67151d0c18d397069ad8c271ba3">BLACK</a> and large case (INTER 32px), subText in <a class="el" href="nbgl__types_8h.html#a0a8ef1b5e1941b7257e545cc33405ff1af77fb67151d0c18d397069ad8c271ba3">BLACK</a> in INTER 24px</li>
<li>if <a class="el" href="nbgl__content_8h.html#a3735e557349f1945eff88ee65ea92fb5a9709023dec2f7e17e254b11bc19c6bcf">NORMAL_INFO</a>, icon in black and main text in INTER 24px in <a class="el" href="nbgl__types_8h.html#a0a8ef1b5e1941b7257e545cc33405ff1af77fb67151d0c18d397069ad8c271ba3">BLACK</a> under it, subText in INTER 24px in <a class="el" href="nbgl__types_8h.html#a0a8ef1b5e1941b7257e545cc33405ff1a656c37aed4a972689007d4c9ce88f425">DARK_GRAY</a> under it</li>
</ul>
<h2><a class="anchor" id="choice_buttons"></a>
Choice buttons</h2>
<p><img src="layout_choice_buttons1.png" alt="" height="300" class="inline" title="caption"/></p>
<p><img src="layout_choice_buttons2.png" alt="" height="300" class="inline" title="caption"/></p>
<p>This object is made of 2 buttons, aligned vertically, each containing a text.</p>
<p>They are put at the bottom of the main container, on top of a potential navigation bar or bottom button.</p>
<p>Regarding colors, Top-button (index 0 in callback) is painted in <a class="el" href="nbgl__types_8h.html#a0a8ef1b5e1941b7257e545cc33405ff1af77fb67151d0c18d397069ad8c271ba3">BLACK</a> and is on top of Bottom-buttom (index 1 in callback)</p>
<p>If the <b>style</b> field is <a class="el" href="nbgl__layout_8h.html#aab86a9d202df5a9f485ac2c164e294e4ac86b4918c86ef6fedc9133ecd70d368e">ROUNDED_AND_FOOTER_STYLE</a>, Bottom-button is painted in <a class="el" href="nbgl__types_8h.html#a0a8ef1b5e1941b7257e545cc33405ff1a283fc479650da98250635b9c3c0e7e50">WHITE</a>, without border.</p>
<p>If the <b>style</b> field is <a class="el" href="nbgl__layout_8h.html#abf343bf957a0d4eb04c39b0e10fb931a">BOTH_ROUNDED_STYLE</a>, Bottom-button is painted in <a class="el" href="nbgl__types_8h.html#a0a8ef1b5e1941b7257e545cc33405ff1a283fc479650da98250635b9c3c0e7e50">WHITE</a>, with border.</p>
<p>The API to insert such an object is <a class="el" href="nbgl__layout_8h.html#aac2e37304029d35b540bafbff04bb0d7">nbgl_layoutAddChoiceButtons()</a>, with <a class="el" href="structnbgl__layoutChoiceButtons__t.html">nbgl_layoutChoiceButtons_t</a> structure</p>
<h2><a class="anchor" id="single_button"></a>
Single button</h2>
<p><img src="stax_layout6.png" alt="" height="300" class="inline" title="caption"/></p>
<p>This object is made of a single button, in <a class="el" href="nbgl__types_8h.html#a0a8ef1b5e1941b7257e545cc33405ff1af77fb67151d0c18d397069ad8c271ba3">BLACK</a>. The text and optional icon are in <a class="el" href="nbgl__types_8h.html#a0a8ef1b5e1941b7257e545cc33405ff1a283fc479650da98250635b9c3c0e7e50">WHITE</a></p>
<p>This button occupies the full width of the screen, except if <b>fittingContent</b> field of <a class="el" href="structnbgl__layoutButton__t.html">nbgl_layoutButton_t</a> is true, and is put at the bottom of the main container, on top of a potential navigation bar or bottom button.</p>
<p>The API to insert such an object is <a class="el" href="nbgl__layout_8h.html#a9e5825c2b1c38f027e6a23925c3d6a65">nbgl_layoutAddButton()</a>, with <a class="el" href="structnbgl__layoutButton__t.html">nbgl_layoutButton_t</a> structure.</p>
<h2><a class="anchor" id="long_press_button"></a>
Long-press button</h2>
<p><img src="layout5.png" alt="" height="300" class="inline" title="caption"/></p>
<p>This object is made of an area containing a progress-bar (empty at the initialization), a text describing the action, and a fake round <a class="el" href="nbgl__types_8h.html#a0a8ef1b5e1941b7257e545cc33405ff1af77fb67151d0c18d397069ad8c271ba3">BLACK</a> button</p>
<p>The whole area is touchable and as long as touched, the progress-bar will be automatically updated. After 3s, the long-press button is considered as "touched", and the action callback is called with the given <b>token</b>.</p>
<p>This button occupies the full width of the screen and is put at the bottom of the main container, on top of a potential navigation bar or bottom button.</p>
<p>The API to insert such an object is <a class="el" href="nbgl__layout_8h.html#ab3673ac4e0978ebb4785930bd6107ee6">nbgl_layoutAddLongPressButton()</a>, with the button text and token as parameters.</p>
<h2><a class="anchor" id="item_values"></a>
Tag/value list</h2>
<p><img src="layout4.png" alt="" height="300" class="inline" title="caption"/></p>
<p>A touchable icon can also be added on right of value:</p>
<p><img src="layout4_bis.png" alt="" height="300" class="inline" title="caption"/></p>
<p>The parameters to draw such an item are:</p>
<ul>
<li>Array of tag/value pairs :<ul>
<li><b>tag</b> being a single line text displayed in <a class="el" href="nbgl__types_8h.html#a0a8ef1b5e1941b7257e545cc33405ff1a656c37aed4a972689007d4c9ce88f425">DARK_GRAY</a> in 24px font</li>
<li><b>value</b> being a multi-line text in <a class="el" href="nbgl__types_8h.html#a0a8ef1b5e1941b7257e545cc33405ff1af77fb67151d0c18d397069ad8c271ba3">BLACK</a> in 32px font (auto-wrap, so long lines are automatically broken at maximum fitting length)</li>
<li><b>icon</b> being buffer containing the 32px 1BPP icon for touchable icon on right of value (can be NULL)</li>
</ul>
</li>
<li>Or a callback (if the array is NULL) to retrieve the pairs one by one</li>
<li>A boolean to wrap or not value field on spaces</li>
<li>A boolean to indicate whether to use a 24 px font for value field (only used when displaying details)</li>
<li>A token that will be used as argument of the callback if icon in any tag/value pair is touched (index is the index of the pair in pairs[])</li>
<li>The maximum number of lines of value field to display (if 0, not used)</li>
</ul>
<p>This area is displayed in the main container, under the previously inserted complex object.</p>
<p>The API to insert such an object is <a class="el" href="nbgl__layout_8h.html#a06073279a7143cc0ee836a67c9b9d61f">nbgl_layoutAddTagValueList()</a>, with <a class="el" href="nbgl__layout_8h.html#ae280e4fad6eed7f4911e2e236b486b9b">nbgl_layoutTagValueList_t</a> structure</p>
<h2><a class="anchor" id="touchable_bar"></a>
Touchable bar</h2>
<p><img src="stax_layout8.png" alt="" height="300" class="inline" title="caption"/></p>
<p>This horizontal bar object is made of:</p>
<ul>
<li>An optional icon on the left, in <a class="el" href="nbgl__types_8h.html#a0a8ef1b5e1941b7257e545cc33405ff1af77fb67151d0c18d397069ad8c271ba3">BLACK</a></li>
<li>An optional text, in <a class="el" href="nbgl__types_8h.html#a0a8ef1b5e1941b7257e545cc33405ff1af77fb67151d0c18d397069ad8c271ba3">BLACK</a></li>
<li>An optional icon on the right, in <a class="el" href="nbgl__types_8h.html#a0a8ef1b5e1941b7257e545cc33405ff1af77fb67151d0c18d397069ad8c271ba3">BLACK</a></li>
</ul>
<p>Some extra fields in <a class="el" href="structnbgl__layoutBar__t.html">nbgl_layoutBar_t</a>, enable to:</p>
<ul>
<li>center text horizontally instead of on the left</li>
<li>gray-out the bar to deactivate it</li>
</ul>
<p>This area is displayed in the main container, under the previously inserted complex object.</p>
<p>If <b>leftIcon</b> and <b>rightIcon</b> fields are NULL, the bar is considered as a title.</p>
<p>When touched, if not inactivated, the <b>token</b> provided in <a class="el" href="structnbgl__layoutBar__t.html">nbgl_layoutBar_t</a> is used with the action callback. <b>index</b> parameter is not relevant.</p>
<p>The API to insert such an object is <a class="el" href="nbgl__layout_8h.html#a69b9abf9a159366d6813db1acdfc0a3a">nbgl_layoutAddTouchableBar()</a>, with <a class="el" href="structnbgl__layoutBar__t.html">nbgl_layoutBar_t</a> structure</p>
<h2><a class="anchor" id="switch"></a>
Switch</h2>
<p><img src="stax_layout15.png" alt="" height="300" class="inline" title="caption"/></p>
<p>This object is made of:</p>
<ul>
<li>A mandatory text, in <a class="el" href="nbgl__types_8h.html#a0a8ef1b5e1941b7257e545cc33405ff1af77fb67151d0c18d397069ad8c271ba3">BLACK</a> and bold, on the left</li>
<li>An optional text, in <a class="el" href="nbgl__types_8h.html#a0a8ef1b5e1941b7257e545cc33405ff1af77fb67151d0c18d397069ad8c271ba3">BLACK</a>, under the mandatory text</li>
<li>A switch, at the given initial state, on the right</li>
</ul>
<p>This area is displayed in the main container, under the previously inserted complex object.</p>
<p>When touched, if not inactivated, the <b>token</b> provided in <a class="el" href="nbgl__layout_8h.html#a5d41990287e2333db9148b73ff5bf16d">nbgl_layoutSwitch_t</a> is used with the action callback. <b>index</b> parameter meaning is 0 for inactive, 1 for active.</p>
<p>The API to insert such an object is <a class="el" href="nbgl__layout_8h.html#a91355a9b0153c407ed0390380d952be3">nbgl_layoutAddSwitch()</a>, with <a class="el" href="nbgl__layout_8h.html#a5d41990287e2333db9148b73ff5bf16d">nbgl_layoutSwitch_t</a> structure</p>
<h2><a class="anchor" id="radio_choices"></a>
Radio button choices</h2>
<p><img src="stax_layout11.png" alt="" height="300" class="inline" title="caption"/></p>
<p>This object is made of a vertical list of <em>nbChoices</em> items made of:</p>
<ul>
<li>A mandatory text, in <a class="el" href="nbgl__types_8h.html#a0a8ef1b5e1941b7257e545cc33405ff1af77fb67151d0c18d397069ad8c271ba3">BLACK</a>, on the left</li>
<li>A radio button, on the right</li>
</ul>
<p>One and only one button is active at the same time in a single object.</p>
<p>Each line of choice is separated from the previous one by a thin horizontal sepatation line.</p>
<p>The active button at start-up is given in <em>initChoice</em> field of <a class="el" href="nbgl__layout_8h.html#a361c85f2996cce4154d6c2fff82dd450">nbgl_layoutRadioChoice_t</a>.</p>
<p>This area is displayed in the main container, under the previously inserted complex object.</p>
<p>The API to insert such an object is <a class="el" href="nbgl__layout_8h.html#a579ca330859e36e12844fa5e0f888f7f">nbgl_layoutAddRadioChoice()</a>, with <a class="el" href="nbgl__layout_8h.html#a361c85f2996cce4154d6c2fff82dd450">nbgl_layoutRadioChoice_t</a> structure</p>
<h2><a class="anchor" id="spinner"></a>
Spinner</h2>
<p><img src="layout2.png" alt="" height="300" class="inline" title="caption"/></p>
<p>This object is a simple centered "Ledger" logo in <a class="el" href="nbgl__types_8h.html#a0a8ef1b5e1941b7257e545cc33405ff1a82a1f4f015ad85784e8c8671b7338433">LIGHT_GRAY</a>, with one of the corner in <a class="el" href="nbgl__types_8h.html#a0a8ef1b5e1941b7257e545cc33405ff1af77fb67151d0c18d397069ad8c271ba3">BLACK</a>, to emulate a spinner, with an explanation text under the spinner</p>
<p>The spinner "rotating" corner will automatically be updated every 800 ms.</p>
<p>The API to insert such an object is <a class="el" href="nbgl__layout_8h.html#af2cbef00c33768329f31c0ea46cdb652">nbgl_layoutAddSpinner()</a>.</p>
<dl class="section warning"><dt>Warning</dt><dd>No other object shall be inserted beside this one.</dd></dl>
<h2><a class="anchor" id="progress_indicator"></a>
Progress indicator</h2>
<p><img src="layout5.png" alt="" height="300" class="inline" title="caption"/></p>
<p>This object, drawned in top of the screen, is essentially made of a discrete page progress bar (slashes or digits). An optional "back" button, symbolized with a left arrow, can also be drawned on the left of the page progress.</p>
<p>The parameters to build this object are:</p>
<ul>
<li>The total number of pages</li>
<li>The current page (from 0 to (total_nb_pages-1))</li>
<li>A boolean to indicate whether to use a "back" button or not</li>
<li>A <b>token</b> used with the action callback when the "back" button is touched</li>
</ul>
<p>Digits are represented instead of slashes if the number of pages exceeds 10. In this case, instead of marking the active page as a slash in <a class="el" href="nbgl__types_8h.html#a0a8ef1b5e1941b7257e545cc33405ff1af77fb67151d0c18d397069ad8c271ba3">BLACK</a>, the page indicator will indicate *"&lt;current_page&gt; of &lt;total_nb_pages&gt;"*</p>
<p>The API to insert such an object is <a class="el" href="nbgl__layout_8h.html#a40329afb610fa59416928950243732e6">nbgl_layoutAddProgressIndicator()</a>.</p>
<dl class="section warning"><dt>Warning</dt><dd>This object is incompatible with top-right button and page selector. </dd>
<dd>
This object is deprecated.</dd></dl>
<h2><a class="anchor" id="qr_code"></a>
QR Code</h2>
<p><img src="stax_layout13.png" alt="" height="300" class="inline" title="caption"/></p>
<p>This object, centered in the main container, is made of a dynamically drawned QR Code (not a picture) and description texts under it.</p>
<p>The parameters to build this object are:</p>
<ul>
<li>The URL corresponding to the address to draw in the QR Code</li>
<li>The optional text to draw under the QR Code (in <a class="el" href="nbgl__types_8h.html#a0a8ef1b5e1941b7257e545cc33405ff1af77fb67151d0c18d397069ad8c271ba3">BLACK</a>, 24px bold)</li>
<li>The optional sub text to draw under the text (in <a class="el" href="nbgl__types_8h.html#a0a8ef1b5e1941b7257e545cc33405ff1af77fb67151d0c18d397069ad8c271ba3">BLACK</a>, 24px regular)</li>
</ul>
<p>The API to insert such an object is <a class="el" href="nbgl__layout_8h.html#a4fc79965e06d7b89d85e35d7d3785a52">nbgl_layoutAddQRCode()</a>, with <a class="el" href="structnbgl__layoutQRCode__t.html">nbgl_layoutQRCode_t</a> structure as parameter.</p>
<dl class="section warning"><dt>Warning</dt><dd>This object is incompatible with top-right button and progress indicator.</dd></dl>
<h2><a class="anchor" id="keyboard_section"></a>
Keyboard-related objects</h2>
<p>Some rare screens require displaying a keyboard at the bottom of the page, to enter text.</p>
<p>The text to enter may be a generic string or a word (for example BIP39). In the first case, a simple confirmation button is also displayed in the screen. In the second case, usually suggestion buttons are displayed to avoid issues with unknown words and save time.</p>
<p>Here are some example of these pages in Bolos UX:</p>
<p><img src="keyboard-usages.png" alt="" height="300" class="inline" title="caption"/></p>
<p>To build such screens, some dedicated APIs are necessary, which will be detailed in the sub-chapters.</p>
<h3><a class="anchor" id="keyboard_sub_section_1"></a>
Adding/Updating keyboard</h3>
<p>This object, at the bottom of the main container (with a margin), proposes a Qwerty keyboard.</p>
<p>The parameters to configure this object are:</p>
<ul>
<li>The mode in which to start the keyboard (letters, digits or special characters)</li>
<li>A boolean to indicate whether to display letters in upper or lower case</li>
<li>A boolean to indicate whether to display only letters, with no space and no shift key to switch between modes</li>
<li>A 32 bits mask used to invalidate (remove) some keys on the keyboard.</li>
<li>A function called when an active key is pressed</li>
</ul>
<p>The API to insert such an object is <a class="el" href="nbgl__layout_8h.html#a0b08c4a792f40edccd1364fd8efccd40">nbgl_layoutAddKeyboard()</a>, with <a class="el" href="structnbgl__layoutKbd__t.html">nbgl_layoutKbd_t</a> structure as parameter.</p>
<p>This function returns a positive integer (if successful) to be used as an index in <a class="el" href="nbgl__layout_8h.html#a09d0e7466b4a3c6a4c7da128232b29d3">nbgl_layoutUpdateKeyboard()</a> function, used to modify the mask of an existing keyboard.</p>
<dl class="section note"><dt>Note</dt><dd>the 32 bits mask works like this:<ul>
<li>If mask[0] bit is 1, the 'q' key is invalid</li>
<li>If mask[1] bit is 1, the 'w' key is invalid</li>
<li>And so on in "qwertyuiopasdfghjklzxcvbnm" string.</li>
<li>"space" key has index 29.</li>
</ul>
</dd></dl>
<h3><a class="anchor" id="keyboard_sub_section_2"></a>
Adding/Updating Keyboard Content</h3>
<p>This container object, which is a complement to a keyboard consists in:</p>
<ul>
<li>An optional title on top of the container</li>
<li>A entered text area (one line)</li>
<li>Either a single confirmation button or several suggestion buttons</li>
</ul>
<p>The buttons are all with black background and white text.</p>
<p>The parameters to configure this object (<a class="el" href="structnbgl__layoutKeyboardContent__t.html">nbgl_layoutKeyboardContent_t</a> structure) are:</p>
<ul>
<li>The type of content (with suggestions or confirmation)</li>
<li>The optional text for title (if NULL, no title)</li>
<li>The entered text to display</li>
<li>A boolean to indicate whether to display a number at the beginning of the line of the entered text</li>
<li>A number to display at the beginning of the line of the entered text (if <b>numbered</b> is true)</li>
<li>A boolean to indicate whether to display the entered text in gray or not.</li>
<li>The token that will be used as argument of the callback when text is touched</li>
<li>Either:<ul>
<li>The description of the suggestions buttons</li>
<li>Or the description of the confirmation button</li>
</ul>
</li>
<li>The tune ID to play when any button is pressed</li>
</ul>
<p>The API to insert such an object is <a class="el" href="nbgl__layout_8h.html#a465870d19e2d8f1a07e332021be2a3c8">nbgl_layoutAddKeyboardContent()</a>.</p>
<p>This function returns a positive integer if successful. This object can be modified with <a class="el" href="nbgl__layout_8h.html#a991f5c48168e09ee81c86c62526c1bb8">nbgl_layoutUpdateKeyboardContent()</a></p>
<h3><a class="anchor" id="keyboard_example_1"></a>
Example 1</h3>
<p><img src="keyboard-example1.png" alt="" height="300" class="inline" title="caption"/></p>
<p>Here is the source code to display this first example:</p>
<div class="fragment"><div class="line"><span class="keyword">enum</span> {</div>
<div class="line">  BACK_BUTTON_TOKEN = 0,</div>
<div class="line">  CONTINUE_BUTTON_TOKEN,</div>
<div class="line">  KBD_TEXT_TOKEN</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">char</span> textToEnter[48];</div>
<div class="line"><span class="keyword">static</span> <a class="code hl_typedef" href="nbgl__layout_8h.html#a8c06300795d2ce7f2a5c59b7c8fe4c01">nbgl_layout_t</a> *layout;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// function called when back or continue button is touched</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> layoutTouchCallback(<span class="keywordtype">int</span> token, <a class="code hl_typedef" href="usbd__conf_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> index) {</div>
<div class="line">  <span class="keywordflow">if</span> (token == BACK_BUTTON_TOKEN) {</div>
<div class="line">    <span class="comment">// go back to main screen of app</span></div>
<div class="line">    <a class="code hl_function" href="nbgl__layout_8h.html#ada5d32fca01db20e6bd4950b07111421">nbgl_layoutRelease</a>(layout);</div>
<div class="line">    app_main();</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (token == CONTINUE_BUTTON_TOKEN) {</div>
<div class="line">    <span class="comment">// do something with entered text</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// go back to main screen of app</span></div>
<div class="line">    <a class="code hl_function" href="nbgl__layout_8h.html#ada5d32fca01db20e6bd4950b07111421">nbgl_layoutRelease</a>(layout);</div>
<div class="line">    app_main();</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (token == KBD_TEXT_TOKEN) {</div>
<div class="line">    <span class="comment">// do something with entered text</span></div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// function called when a key of keyboard is touched</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> keyboardCallback(<span class="keywordtype">char</span> touchedKey) {</div>
<div class="line">  <a class="code hl_struct" href="structnbgl__layoutKeyboardContent__t.html">nbgl_layoutKeyboardContent_t</a> kbdContent = {</div>
<div class="line">    .<a class="code hl_variable" href="structnbgl__layoutKeyboardContent__t.html#ae21e8245f6274f1e8dbd60e87ed519f2">title</a>                     = NULL,</div>
<div class="line">    .type                      = <a class="code hl_enumvalue" href="nbgl__layout_8h.html#ad0f906c1d5ba1a46f272422ad4cabcaeacabff9c055a1935883ac55f9fc119fee">KEYBOARD_WITH_BUTTON</a>,</div>
<div class="line">    .numbered                  = <span class="keyword">false</span>,</div>
<div class="line">    .text                      = textToEnter,</div>
<div class="line">    .grayedOut                 = <span class="keyword">true</span>,</div>
<div class="line">    .textToken                 = KBD_TEXT_TOKEN,</div>
<div class="line">    .tuneId                    = TUNE_TAP_CASUAL,</div>
<div class="line">    .confirmationButton.active = <span class="keyword">false</span>,</div>
<div class="line">    .confirmationButton.text   = <span class="stringliteral">&quot;Continue&quot;</span>,</div>
<div class="line">    .confirmationButton.token  = CONFIRM_BUTTON_TOKEN</div>
<div class="line">  };</div>
<div class="line">  <span class="comment">// if not Backspace</span></div>
<div class="line">  <span class="keywordflow">if</span> (touchedKey != <a class="code hl_define" href="nbgl__obj_8h.html#a899616376b07e20f03dbae5894465a92">BACKSPACE_KEY</a>) {</div>
<div class="line">    <span class="keywordtype">int</span> textLen = strlen(textToEnter);</div>
<div class="line">    textToEnter[textLen] = touchedKey;</div>
<div class="line">    textToEnter[textLen+1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> { <span class="comment">// backspace</span></div>
<div class="line">    <span class="keywordtype">int</span> textLen = strlen(textToEnter);</div>
<div class="line">    <span class="keywordflow">if</span> (textLen == 0)</div>
<div class="line">      <span class="keywordflow">return</span>;</div>
<div class="line">    textToEnter[textLen-1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="comment">// be sure to redraw the text</span></div>
<div class="line">  <a class="code hl_function" href="nbgl__layout_8h.html#a991f5c48168e09ee81c86c62526c1bb8">nbgl_layoutUpdateKeyboardContent</a>(layout,textIndex,<span class="keyword">false</span>,0,textToEnter,<span class="keyword">false</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> app_keyboard(<span class="keywordtype">void</span>) {</div>
<div class="line">    <a class="code hl_struct" href="structnbgl__layoutDescription__s.html">nbgl_layoutDescription_t</a> layoutDescription = {</div>
<div class="line">      .<a class="code hl_variable" href="structnbgl__layoutDescription__s.html#a0768b0863e64e44da3ebab04aca0ca6b">modal</a> = <span class="keyword">false</span>,</div>
<div class="line">      .onActionCallback = &amp;layoutTouchCallback</div>
<div class="line">    };</div>
<div class="line">    <a class="code hl_struct" href="structnbgl__layoutKbd__t.html">nbgl_layoutKbd_t</a> kbdInfo = {</div>
<div class="line">      .<a class="code hl_variable" href="structnbgl__layoutKbd__t.html#ac4307a2e77821a9ba43aa46cdfc60624">callback</a> = keyboardCallback,</div>
<div class="line">      .keyMask = 0,         <span class="comment">// no inactive key</span></div>
<div class="line">      .lettersOnly = <span class="keyword">false</span>, <span class="comment">// full keyboard</span></div>
<div class="line">      .mode = <a class="code hl_enumvalue" href="nbgl__obj_8h.html#aa61b9adfb699753b7ee4beb6fcf9c915a567e2801898f0fa88d0f5bce58badf86">MODE_LETTERS</a>, <span class="comment">// start in letters mode</span></div>
<div class="line">      .upperCase = <span class="keyword">false</span>    <span class="comment">// start with lower case letters</span></div>
<div class="line">    };</div>
<div class="line">    <a class="code hl_struct" href="structnbgl__layoutKeyboardContent__t.html">nbgl_layoutKeyboardContent_t</a> kbdContent = {</div>
<div class="line">      .<a class="code hl_variable" href="structnbgl__layoutKeyboardContent__t.html#ae21e8245f6274f1e8dbd60e87ed519f2">title</a>                     = NULL,</div>
<div class="line">      .type                      = <a class="code hl_enumvalue" href="nbgl__layout_8h.html#ad0f906c1d5ba1a46f272422ad4cabcaeacabff9c055a1935883ac55f9fc119fee">KEYBOARD_WITH_BUTTON</a>,</div>
<div class="line">      .numbered                  = <span class="keyword">false</span>,</div>
<div class="line">      .text                      = textToEnter,</div>
<div class="line">      .grayedOut                 = <span class="keyword">true</span>,</div>
<div class="line">      .textToken                 = KBD_TEXT_TOKEN,</div>
<div class="line">      .tuneId                    = TUNE_TAP_CASUAL,</div>
<div class="line">      .confirmationButton.active = <span class="keyword">false</span>,</div>
<div class="line">      .confirmationButton.text   = <span class="stringliteral">&quot;Continue&quot;</span>,</div>
<div class="line">      .confirmationButton.token  = CONFIRM_BUTTON_TOKEN</div>
<div class="line">    };</div>
<div class="line">    <a class="code hl_struct" href="structnbgl__layoutHeader__t.html">nbgl_layoutHeader_t</a> headerDesc = {.<a class="code hl_variable" href="structnbgl__layoutHeader__t.html#a0936b9fb46c771f3605256872def7591">type</a>               = <a class="code hl_enumvalue" href="nbgl__layout_8h.html#a9879d9ceabe625bd287de2af3ca3b52aa98155fa3797a7ca12d107b3d8dbdc344">HEADER_BACK_AND_TEXT</a>,</div>
<div class="line">                                      .separationLine     = <span class="keyword">false</span>,</div>
<div class="line">                                      .backAndText.token  = BACK_BUTTON_TOKEN,</div>
<div class="line">                                      .backAndText.tuneId = TUNE_TAP_CASUAL,</div>
<div class="line">                                      .backAndText.text   = NULL};</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// get layout</span></div>
<div class="line">    layout = <a class="code hl_function" href="nbgl__layout_8h.html#a9ff89401d84106e775567a11c40769b7">nbgl_layoutGet</a>(&amp;layoutDescription);</div>
<div class="line">    <span class="comment">// add back key</span></div>
<div class="line">    <a class="code hl_function" href="nbgl__layout_8h.html#ac714c5aee3cd8589f8893f979aeeadf8">nbgl_layoutAddHeader</a>(layout, &amp;headerDesc);</div>
<div class="line">    <span class="comment">// add keyboard</span></div>
<div class="line">    <a class="code hl_function" href="nbgl__layout_8h.html#a0b08c4a792f40edccd1364fd8efccd40">nbgl_layoutAddKeyboard</a>(layout, &amp;kbdInfo);</div>
<div class="line">    <span class="comment">// add keyboard content</span></div>
<div class="line">    <a class="code hl_function" href="nbgl__layout_8h.html#a465870d19e2d8f1a07e332021be2a3c8">nbgl_layoutAddKeyboardContent</a>(layout, &amp;kbdContent);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// draw layout</span></div>
<div class="line">    <a class="code hl_function" href="nbgl__layout_8h.html#a6805bf1d2b7adab8d89fc9e67e3053f9">nbgl_layoutDraw</a>(layout);</div>
<div class="line">}</div>
<div class="ttc" id="anbgl__layout_8h_html_a0b08c4a792f40edccd1364fd8efccd40"><div class="ttname"><a href="nbgl__layout_8h.html#a0b08c4a792f40edccd1364fd8efccd40">nbgl_layoutAddKeyboard</a></div><div class="ttdeci">int nbgl_layoutAddKeyboard(nbgl_layout_t *layout, const nbgl_layoutKbd_t *kbdInfo)</div><div class="ttdoc">Creates a keyboard on bottom of the screen, with the given configuration.</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout__keyboard_8c_source.html#l00474">nbgl_layout_keyboard.c:474</a></div></div>
<div class="ttc" id="anbgl__layout_8h_html_a465870d19e2d8f1a07e332021be2a3c8"><div class="ttname"><a href="nbgl__layout_8h.html#a465870d19e2d8f1a07e332021be2a3c8">nbgl_layoutAddKeyboardContent</a></div><div class="ttdeci">int nbgl_layoutAddKeyboardContent(nbgl_layout_t *layout, nbgl_layoutKeyboardContent_t *content)</div><div class="ttdoc">Adds an area containing a potential title, a text entry and either confirmation or suggestion buttons...</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout__keyboard_8c_source.html#l00965">nbgl_layout_keyboard.c:965</a></div></div>
<div class="ttc" id="anbgl__layout_8h_html_a6805bf1d2b7adab8d89fc9e67e3053f9"><div class="ttname"><a href="nbgl__layout_8h.html#a6805bf1d2b7adab8d89fc9e67e3053f9">nbgl_layoutDraw</a></div><div class="ttdeci">int nbgl_layoutDraw(nbgl_layout_t *layout)</div><div class="ttdoc">Applies given layout. The screen will be redrawn.</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout_8c_source.html#l03337">nbgl_layout.c:3337</a></div></div>
<div class="ttc" id="anbgl__layout_8h_html_a9879d9ceabe625bd287de2af3ca3b52aa98155fa3797a7ca12d107b3d8dbdc344"><div class="ttname"><a href="nbgl__layout_8h.html#a9879d9ceabe625bd287de2af3ca3b52aa98155fa3797a7ca12d107b3d8dbdc344">HEADER_BACK_AND_TEXT</a></div><div class="ttdeci">@ HEADER_BACK_AND_TEXT</div><div class="ttdoc">back key and optional text</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout_8h_source.html#l00407">nbgl_layout.h:407</a></div></div>
<div class="ttc" id="anbgl__layout_8h_html_a991f5c48168e09ee81c86c62526c1bb8"><div class="ttname"><a href="nbgl__layout_8h.html#a991f5c48168e09ee81c86c62526c1bb8">nbgl_layoutUpdateKeyboardContent</a></div><div class="ttdeci">int nbgl_layoutUpdateKeyboardContent(nbgl_layout_t *layout, nbgl_layoutKeyboardContent_t *content)</div><div class="ttdoc">Updates an area containing a potential title, a text entry and either confirmation or suggestion butt...</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout__keyboard_8c_source.html#l01039">nbgl_layout_keyboard.c:1039</a></div></div>
<div class="ttc" id="anbgl__layout_8h_html_ac714c5aee3cd8589f8893f979aeeadf8"><div class="ttname"><a href="nbgl__layout_8h.html#ac714c5aee3cd8589f8893f979aeeadf8">nbgl_layoutAddHeader</a></div><div class="ttdeci">int nbgl_layoutAddHeader(nbgl_layout_t *layout, const nbgl_layoutHeader_t *headerDesc)</div><div class="ttdoc">Creates a touchable (or not) area at the header of the screen, containing various controls,...</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout_8c_source.html#l02286">nbgl_layout.c:2286</a></div></div>
<div class="ttc" id="anbgl__layout_8h_html_ad0f906c1d5ba1a46f272422ad4cabcaeacabff9c055a1935883ac55f9fc119fee"><div class="ttname"><a href="nbgl__layout_8h.html#ad0f906c1d5ba1a46f272422ad4cabcaeacabff9c055a1935883ac55f9fc119fee">KEYBOARD_WITH_BUTTON</a></div><div class="ttdeci">@ KEYBOARD_WITH_BUTTON</div><div class="ttdoc">text entry area + confirmation button</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout_8h_source.html#l00354">nbgl_layout.h:354</a></div></div>
<div class="ttc" id="anbgl__layout_8h_html_ada5d32fca01db20e6bd4950b07111421"><div class="ttname"><a href="nbgl__layout_8h.html#ada5d32fca01db20e6bd4950b07111421">nbgl_layoutRelease</a></div><div class="ttdeci">int nbgl_layoutRelease(nbgl_layout_t *layout)</div><div class="ttdoc">Release the layout obtained with nbgl_layoutGet()</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout_8c_source.html#l03368">nbgl_layout.c:3368</a></div></div>
<div class="ttc" id="anbgl__obj_8h_html_a899616376b07e20f03dbae5894465a92"><div class="ttname"><a href="nbgl__obj_8h.html#a899616376b07e20f03dbae5894465a92">BACKSPACE_KEY</a></div><div class="ttdeci">#define BACKSPACE_KEY</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__obj_8h_source.html#l00026">nbgl_obj.h:26</a></div></div>
<div class="ttc" id="anbgl__obj_8h_html_aa61b9adfb699753b7ee4beb6fcf9c915a567e2801898f0fa88d0f5bce58badf86"><div class="ttname"><a href="nbgl__obj_8h.html#aa61b9adfb699753b7ee4beb6fcf9c915a567e2801898f0fa88d0f5bce58badf86">MODE_LETTERS</a></div><div class="ttdeci">@ MODE_LETTERS</div><div class="ttdoc">letters mode</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__obj_8h_source.html#l00474">nbgl_obj.h:474</a></div></div>
<div class="ttc" id="astructnbgl__layoutHeader__t_html"><div class="ttname"><a href="structnbgl__layoutHeader__t.html">nbgl_layoutHeader_t</a></div><div class="ttdoc">This structure contains info to build a header.</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout_8h_source.html#l00419">nbgl_layout.h:419</a></div></div>
<div class="ttc" id="astructnbgl__layoutHeader__t_html_a0936b9fb46c771f3605256872def7591"><div class="ttname"><a href="structnbgl__layoutHeader__t.html#a0936b9fb46c771f3605256872def7591">nbgl_layoutHeader_t::type</a></div><div class="ttdeci">nbgl_layoutHeaderType_t type</div><div class="ttdoc">type of header</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout_8h_source.html#l00420">nbgl_layout.h:420</a></div></div>
<div class="ttc" id="astructnbgl__layoutKbd__t_html"><div class="ttname"><a href="structnbgl__layoutKbd__t.html">nbgl_layoutKbd_t</a></div><div class="ttdoc">This structure contains info to build a keyboard with nbgl_layoutAddKeyboard()</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout_8h_source.html#l00564">nbgl_layout.h:564</a></div></div>
<div class="ttc" id="astructnbgl__layoutKbd__t_html_ac4307a2e77821a9ba43aa46cdfc60624"><div class="ttname"><a href="structnbgl__layoutKbd__t.html#ac4307a2e77821a9ba43aa46cdfc60624">nbgl_layoutKbd_t::callback</a></div><div class="ttdeci">keyboardCallback_t callback</div><div class="ttdoc">function called when an active key is pressed</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout_8h_source.html#l00568">nbgl_layout.h:568</a></div></div>
<div class="ttc" id="astructnbgl__layoutKeyboardContent__t_html"><div class="ttname"><a href="structnbgl__layoutKeyboardContent__t.html">nbgl_layoutKeyboardContent_t</a></div><div class="ttdoc">This structure contains info to build a keyboard content (controls that are linked to keyboard)</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout_8h_source.html#l00381">nbgl_layout.h:381</a></div></div>
<div class="ttc" id="astructnbgl__layoutKeyboardContent__t_html_ae21e8245f6274f1e8dbd60e87ed519f2"><div class="ttname"><a href="structnbgl__layoutKeyboardContent__t.html#ae21e8245f6274f1e8dbd60e87ed519f2">nbgl_layoutKeyboardContent_t::title</a></div><div class="ttdeci">const char * title</div><div class="ttdoc">centered title explaining the screen</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout_8h_source.html#l00383">nbgl_layout.h:383</a></div></div>
<div class="ttc" id="ausbd__conf_8h_html_aba7bc1797add20fe3efdf37ced1182c5"><div class="ttname"><a href="usbd__conf_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a></div><div class="ttdeci">unsigned char uint8_t</div><div class="ttdef"><b>Definition:</b> <a href="usbd__conf_8h_source.html#l00053">usbd_conf.h:53</a></div></div>
</div><!-- fragment --><h3><a class="anchor" id="keyboard_example_2"></a>
Example 2</h3>
<p><img src="keyboard-example2.png" alt="" height="300" class="inline" title="caption"/></p>
<p>Here is the source code to display this second example (with simulated transitions):</p>
<div class="fragment"><div class="line"><span class="keyword">enum</span> {</div>
<div class="line">  BACK_BUTTON_TOKEN = 0,</div>
<div class="line">  FIRST_SUGGESTION_TOKEN,</div>
<div class="line">  KBD_TEXT_TOKEN</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code hl_typedef" href="nbgl__layout_8h.html#a8c06300795d2ce7f2a5c59b7c8fe4c01">nbgl_layout_t</a> *layout;</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">char</span> textToEnter[20];</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">char</span> headerText[48];</div>
<div class="line"><span class="keyword">static</span> <a class="code hl_typedef" href="nbgl__layout_8h.html#a8c06300795d2ce7f2a5c59b7c8fe4c01">nbgl_layout_t</a> *layout;</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> wordNum;</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">char</span> *buttonTexts[<a class="code hl_define" href="nbgl__layout_8h.html#a841339a91d8bed1dcfa2b7e6f0774ffb">NB_MAX_SUGGESTION_BUTTONS</a>] = {0};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// function called when back or any suggestion button is touched</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> layoutTouchCallback(<span class="keywordtype">int</span> token, <a class="code hl_typedef" href="usbd__conf_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> index) {</div>
<div class="line">  <span class="keywordflow">if</span> (token == BACK_BUTTON_TOKEN) {</div>
<div class="line">    <span class="comment">// go back to main screen of app</span></div>
<div class="line">    <a class="code hl_function" href="nbgl__layout_8h.html#ada5d32fca01db20e6bd4950b07111421">nbgl_layoutRelease</a>(layout);</div>
<div class="line">    app_main();</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (token &gt;= FIRST_SUGGESTION_TOKEN) {</div>
<div class="line">    <span class="comment">// do something with touched button</span></div>
<div class="line">    printf(<span class="stringliteral">&quot;Selected word is %s\n&quot;</span>, buttonTexts[token - FIRST_SUGGESTION_TOKEN]);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// go back to main screen of app</span></div>
<div class="line">    <a class="code hl_function" href="nbgl__layout_8h.html#ada5d32fca01db20e6bd4950b07111421">nbgl_layoutRelease</a>(layout);</div>
<div class="line">    app_main();</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// function called when a key of keyboard is touched</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> keyboardCallback(<span class="keywordtype">char</span> touchedKey) {</div>
<div class="line">  nbgl_layoutKbdContent_t kbdContent = {</div>
<div class="line">    .<a class="code hl_variable" href="structnbgl__layoutKeyboardContent__t.html#ae21e8245f6274f1e8dbd60e87ed519f2">title</a>                              = headerText,</div>
<div class="line">    .type                               = <a class="code hl_enumvalue" href="nbgl__layout_8h.html#ad0f906c1d5ba1a46f272422ad4cabcaeacdfe2a78b73bbe08c23accaa31cf905c">KEYBOARD_WITH_SUGGESTIONS</a>,</div>
<div class="line">    .numbered                           = <span class="keyword">true</span>,</div>
<div class="line">    .number                             = G_bolos_ux_context.onboarding_step + 1,</div>
<div class="line">    .text                               = <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">    .grayedOut                          = <span class="keyword">false</span>,</div>
<div class="line">    .textToken                          = KBD_TEXT_TOKEN,</div>
<div class="line">    .tuneId                             = TUNE_TAP_CASUAL,</div>
<div class="line">    .suggestionButtons.buttons          = (<span class="keyword">const</span> <span class="keywordtype">char</span> **) buttonTexts,</div>
<div class="line">    .suggestionButtons.firstButtonToken = FIRST_SUGGESTION_TOKEN,</div>
<div class="line">    .suggestionButtons.nbUsedButtons    = 0</div>
<div class="line">  };</div>
<div class="line">  <span class="comment">// if not Backspace</span></div>
<div class="line">  <span class="keywordflow">if</span> (touchedKey != <a class="code hl_define" href="nbgl__obj_8h.html#a899616376b07e20f03dbae5894465a92">BACKSPACE_KEY</a>) {</div>
<div class="line">    <span class="keywordtype">int</span> textLen = strlen(textToEnter);</div>
<div class="line">    textToEnter[textLen] = touchedKey;</div>
<div class="line">    textToEnter[textLen+1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> { <span class="comment">// backspace</span></div>
<div class="line">    <span class="keywordtype">int</span> textLen = strlen(textToEnter);</div>
<div class="line">    <span class="keywordflow">if</span> (textLen == 0)</div>
<div class="line">      <span class="keywordflow">return</span>;</div>
<div class="line">    textToEnter[textLen-1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (textLen == 0) {</div>
<div class="line">    <span class="comment">// remove any suggestion buttons because empty string</span></div>
<div class="line">    bdContent.suggestionButtons.nbUsedButtons    = 0;</div>
<div class="line">    <span class="comment">// clear keyboard mask</span></div>
<div class="line">    <a class="code hl_function" href="nbgl__layout_8h.html#a09d0e7466b4a3c6a4c7da128232b29d3">nbgl_layoutUpdateKeyboard</a>(layout,keyboardIndex, 0x0, <a class="code hl_enumvalue" href="nbgl__obj_8h.html#a526042c25a10ab7633bf29bd1cca44cea3eca86ab8a54bfcb4cdd71b7cbf530fc">LOWER_CASE</a>);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="comment">// find up to NB_MAX_SUGGESTION_BUTTONS words beginning with textToEnter</span></div>
<div class="line">    <span class="keywordtype">int</span> nbMatchingWords = getWordsBeginningWith(textToEnter, buttonTexts, <a class="code hl_define" href="nbgl__layout_8h.html#a841339a91d8bed1dcfa2b7e6f0774ffb">NB_MAX_SUGGESTION_BUTTONS</a>);</div>
<div class="line">    <span class="comment">// use them for buttons</span></div>
<div class="line">    kbdContent.suggestionButtons.nbUsedButtons    = nbMatchingWords</div>
<div class="line">    <span class="comment">// get keys to mask on keyboard for possible next letters</span></div>
<div class="line">    uint32_t mask = getKeyboardMask(textToEnter);</div>
<div class="line">    <span class="comment">// use it for keyboard</span></div>
<div class="line">    <a class="code hl_function" href="nbgl__layout_8h.html#a09d0e7466b4a3c6a4c7da128232b29d3">nbgl_layoutUpdateKeyboard</a>(layout,keyboardIndex, mask, <a class="code hl_enumvalue" href="nbgl__obj_8h.html#a526042c25a10ab7633bf29bd1cca44cea3eca86ab8a54bfcb4cdd71b7cbf530fc">LOWER_CASE</a>);</div>
<div class="line">  }</div>
<div class="line">  <span class="comment">// update keyboard content</span></div>
<div class="line">  <a class="code hl_function" href="nbgl__layout_8h.html#a991f5c48168e09ee81c86c62526c1bb8">nbgl_layoutUpdateKeyboardContent</a>(&amp;kbdContent);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// and refresh screen</span></div>
<div class="line">  <a class="code hl_function" href="nbgl__obj_8h.html#a2c321e01f64784c5249e594b795bf252">nbgl_refresh</a>();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> app_keyboard(<span class="keywordtype">void</span>) {</div>
<div class="line">    <a class="code hl_struct" href="structnbgl__layoutDescription__s.html">nbgl_layoutDescription_t</a> layoutDescription = {</div>
<div class="line">      .<a class="code hl_variable" href="structnbgl__layoutDescription__s.html#a0768b0863e64e44da3ebab04aca0ca6b">modal</a> = <span class="keyword">false</span>,</div>
<div class="line">      .onActionCallback = &amp;layoutTouchCallback</div>
<div class="line">    };</div>
<div class="line">    <a class="code hl_struct" href="structnbgl__layoutKbd__t.html">nbgl_layoutKbd_t</a> kbdInfo = {</div>
<div class="line">      .<a class="code hl_variable" href="structnbgl__layoutKbd__t.html#ac4307a2e77821a9ba43aa46cdfc60624">callback</a> = keyboardCallback,</div>
<div class="line">      .keyMask = 0,         <span class="comment">// no inactive key</span></div>
<div class="line">      .lettersOnly = <span class="keyword">true</span>,  <span class="comment">// use only letters</span></div>
<div class="line">      .mode = <a class="code hl_enumvalue" href="nbgl__obj_8h.html#aa61b9adfb699753b7ee4beb6fcf9c915a567e2801898f0fa88d0f5bce58badf86">MODE_LETTERS</a>, <span class="comment">// start in letters mode</span></div>
<div class="line">      .upperCase = <span class="keyword">false</span>    <span class="comment">// start with lower case letters</span></div>
<div class="line">    };</div>
<div class="line">    nbgl_layoutKbdContent_t kbdContent = {</div>
<div class="line">      .title                              = headerText,</div>
<div class="line">      .type                               = <a class="code hl_enumvalue" href="nbgl__layout_8h.html#ad0f906c1d5ba1a46f272422ad4cabcaeacdfe2a78b73bbe08c23accaa31cf905c">KEYBOARD_WITH_SUGGESTIONS</a>,</div>
<div class="line">      .numbered                           = <span class="keyword">true</span>,</div>
<div class="line">      .number                             = G_bolos_ux_context.onboarding_step + 1,</div>
<div class="line">      .text                               = <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">      .grayedOut                          = <span class="keyword">false</span>,</div>
<div class="line">      .textToken                          = KBD_TEXT_TOKEN,</div>
<div class="line">      .tuneId                             = TUNE_TAP_CASUAL,</div>
<div class="line">      .suggestionButtons.buttons          = (<span class="keyword">const</span> <span class="keywordtype">char</span> **) buttonTexts,</div>
<div class="line">      .suggestionButtons.firstButtonToken = FIRST_SUGGESTION_TOKEN,</div>
<div class="line">      .suggestionButtons.nbUsedButtons    = 0</div>
<div class="line">    };</div>
<div class="line">    <a class="code hl_struct" href="structnbgl__layoutHeader__t.html">nbgl_layoutHeader_t</a> headerDesc = {.<a class="code hl_variable" href="structnbgl__layoutHeader__t.html#a0936b9fb46c771f3605256872def7591">type</a>               = <a class="code hl_enumvalue" href="nbgl__layout_8h.html#a9879d9ceabe625bd287de2af3ca3b52aa98155fa3797a7ca12d107b3d8dbdc344">HEADER_BACK_AND_TEXT</a>,</div>
<div class="line">                                      .separationLine     = <span class="keyword">false</span>,</div>
<div class="line">                                      .backAndText.token  = BACK_BUTTON_TOKEN,</div>
<div class="line">                                      .backAndText.tuneId = TUNE_TAP_CASUAL,</div>
<div class="line">                                      .backAndText.text   = NULL};</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// get layout</span></div>
<div class="line">    layout = <a class="code hl_function" href="nbgl__layout_8h.html#a9ff89401d84106e775567a11c40769b7">nbgl_layoutGet</a>(&amp;layoutDescription);</div>
<div class="line">    <span class="comment">// add back key</span></div>
<div class="line">    <a class="code hl_function" href="nbgl__layout_8h.html#ac714c5aee3cd8589f8893f979aeeadf8">nbgl_layoutAddHeader</a>(layout, &amp;headerDesc);</div>
<div class="line">    <span class="comment">// add keyboard</span></div>
<div class="line">    <a class="code hl_function" href="nbgl__layout_8h.html#a0b08c4a792f40edccd1364fd8efccd40">nbgl_layoutAddKeyboard</a>(layout, &amp;kbdInfo);</div>
<div class="line">    <span class="comment">//add keyboard content (will be removed later)</span></div>
<div class="line">    wordNum = 1;</div>
<div class="line">    sprintf(headerText, <span class="stringliteral">&quot;Enter word no.%d from your Recovery Sheet&quot;</span>,wordNum);</div>
<div class="line">    strcpy(textToEnter,<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="nbgl__layout_8h.html#a465870d19e2d8f1a07e332021be2a3c8">nbgl_layoutAddKeyboardContent</a>(layout, &amp;kbdContent);</div>
<div class="line">    <span class="comment">// draw layout</span></div>
<div class="line">    <a class="code hl_function" href="nbgl__layout_8h.html#a6805bf1d2b7adab8d89fc9e67e3053f9">nbgl_layoutDraw</a>(layout);</div>
<div class="line">}</div>
<div class="ttc" id="anbgl__layout_8h_html_a09d0e7466b4a3c6a4c7da128232b29d3"><div class="ttname"><a href="nbgl__layout_8h.html#a09d0e7466b4a3c6a4c7da128232b29d3">nbgl_layoutUpdateKeyboard</a></div><div class="ttdeci">int nbgl_layoutUpdateKeyboard(nbgl_layout_t *layout, uint8_t index, uint32_t keyMask, bool updateCasing, keyboardCase_t casing)</div><div class="ttdoc">Updates an existing keyboard on bottom of the screen, with the given configuration.</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout__keyboard_8c_source.html#l00543">nbgl_layout_keyboard.c:543</a></div></div>
<div class="ttc" id="anbgl__layout_8h_html_a841339a91d8bed1dcfa2b7e6f0774ffb"><div class="ttname"><a href="nbgl__layout_8h.html#a841339a91d8bed1dcfa2b7e6f0774ffb">NB_MAX_SUGGESTION_BUTTONS</a></div><div class="ttdeci">#define NB_MAX_SUGGESTION_BUTTONS</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout_8h_source.html#l00053">nbgl_layout.h:53</a></div></div>
<div class="ttc" id="anbgl__layout_8h_html_ad0f906c1d5ba1a46f272422ad4cabcaeacdfe2a78b73bbe08c23accaa31cf905c"><div class="ttname"><a href="nbgl__layout_8h.html#ad0f906c1d5ba1a46f272422ad4cabcaeacdfe2a78b73bbe08c23accaa31cf905c">KEYBOARD_WITH_SUGGESTIONS</a></div><div class="ttdeci">@ KEYBOARD_WITH_SUGGESTIONS</div><div class="ttdoc">text entry area + suggestion buttons</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__layout_8h_source.html#l00353">nbgl_layout.h:353</a></div></div>
<div class="ttc" id="anbgl__obj_8h_html_a2c321e01f64784c5249e594b795bf252"><div class="ttname"><a href="nbgl__obj_8h.html#a2c321e01f64784c5249e594b795bf252">nbgl_refresh</a></div><div class="ttdeci">void nbgl_refresh(void)</div><div class="ttdoc">This functions refreshes the actual screen on display with what has changed since the last refresh.</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__obj_8c_source.html#l01561">nbgl_obj.c:1561</a></div></div>
<div class="ttc" id="anbgl__obj_8h_html_a526042c25a10ab7633bf29bd1cca44cea3eca86ab8a54bfcb4cdd71b7cbf530fc"><div class="ttname"><a href="nbgl__obj_8h.html#a526042c25a10ab7633bf29bd1cca44cea3eca86ab8a54bfcb4cdd71b7cbf530fc">LOWER_CASE</a></div><div class="ttdeci">@ LOWER_CASE</div><div class="ttdoc">lower case mode</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__obj_8h_source.html#l00490">nbgl_obj.h:490</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="keypad_section"></a>
Keypad-related objects</h2>
<p>Some rare screens require displaying a keypad at the bottom of the page, to enter digits.</p>
<p>The digits to enter are usually a PIN code, so enter or to confirm.</p>
<p>Here are some example of these pages in Bolos UX:</p>
<p><img src="keypad-usages.png" alt="" height="300" class="inline" title="caption"/></p>
<p>To build such screens, some dedicated APIs are necessary, which will be detailed in the sub-chapters.</p>
<h3><a class="anchor" id="keypad_sub_section_1"></a>
Adding/Updating keypad</h3>
<p>This object, at the bottom of the main container (with a margin), proposes a regular keypad, with 10 digits, a backspace and a validate keys.</p>
<p>The only parameters to configure this object are:</p>
<ul>
<li>the callback associated with active keypad keys touch events. Only digit keys are active.</li>
<li>a boolean to choose between shuffled and regular digits.</li>
</ul>
<p>The API to insert such an object is <a class="el" href="nbgl__layout_8h.html#aeeeef4726fe0c1536df12d91d726d6e9">nbgl_layoutAddKeypad()</a>.</p>
<p>This function returns a positive integer (if successful) to be used as an index in <a class="el" href="nbgl__layout_8h.html#a3f8928e8293f86039e73c1a937facf87">nbgl_layoutUpdateKeypad()</a> function, used to modify the mask (active keys) of an existing keypad.</p>
<h3><a class="anchor" id="keypad_sub_section_2"></a>
Adding/Updating keypad content</h3>
<p>This object consists in:</p><ul>
<li>an optional title</li>
<li>either:<ul>
<li>up to 12 discs (invisible or visible) corresponding to hidden entered/not entered digits.</li>
<li>or up to 12 digits if not hidden</li>
</ul>
</li>
</ul>
<p>The parameters to configure this object are:</p>
<ul>
<li>The optional title (NULL if not used)</li>
<li>A boolean to indicate whether digits are hidden or not</li>
<li>The number of total digits to be displayed (all digits are considered as "not entered")</li>
<li>The digits to be displayed if not hidden</li>
</ul>
<p>The API to insert such an object is <a class="el" href="nbgl__layout_8h.html#a9cde15c5abede6ba44dd4f4e7ebec90c">nbgl_layoutAddKeypadContent()</a>.</p>
<p>This function returns a positive integer (if successful).</p>
<p>The <a class="el" href="nbgl__layout_8h.html#a9fbc4a4a6ee4c9a455439602a3cec973">nbgl_layoutUpdateKeypadContent()</a> function can be used to modify the number of entered digits or the digits.</p>
<h1><a class="anchor" id="refresh_layout"></a>
Refreshing screen</h1>
<p>After having drawn graphic objects in <b>framebuffer</b>, it is necessary to transfer the content of the <b>framebuffer</b> on display. This operation is called a refresh.</p>
<p>The API to do that is <a class="el" href="nbgl__obj_8h.html#a2c321e01f64784c5249e594b795bf252">nbgl_refresh()</a> (in <a class="el" href="nbgl__obj_8h.html" title="API to draw all basic graphic objects.">nbgl_obj.h</a>)</p>
<p>It will only refresh the rectangle part of the screen having changed (with objects redrawn) since the last refresh.</p>
<h1><a class="anchor" id="callbacks"></a>
Control actions management</h1>
<p>Some controls, like a touchable bar, or a choice by radio buttons, can be interacted with thanks to the Touchscreen.</p>
<p>The developer can subscribe to these events by providing an action callback in <a class="el" href="nbgl__layout_8h.html#a9ff89401d84106e775567a11c40769b7">nbgl_layoutGet()</a>, with <a class="el" href="nbgl__layout_8h.html#a01348bb7cb5aebd69dcf87806ea58aa7">nbgl_layoutTouchCallback_t</a> prototype.</p>
<p>The first parameter (<em>token</em>) of this function is a token provided along with the definition of the complex object.</p>
<p>The second parameter (<em>index</em>) is only used for some types of complex objects:</p>
<ul>
<li><b>Navigation bar</b>: in this case, <em>index</em> gives the index of the new active page, when navigating.</li>
<li><b>Radio button choices</b>: in this case, <em>index</em> gives the index of the selected choice.</li>
<li><b>Switches</b>: in this case, if <em>index</em> is 0 it means OFF, otherwise it means ON.</li>
<li><b>Choice buttons</b>: in this case, if <em>index</em> is 0, it means top-button (choice 1), otherwise it means bottom-buttom (choice 2)</li>
</ul>
<h2><a class="anchor" id="release"></a>
Releasing a layout</h2>
<p>Before leaving a screen built with a layout, it must be released with a call to <a class="el" href="nbgl__layout_8h.html#ada5d32fca01db20e6bd4950b07111421">nbgl_layoutRelease()</a>. It will free the potentially allocated objects. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
