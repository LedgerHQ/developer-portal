<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Embedded SDK: Predefined pages API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Embedded SDK
   </div>
   <div id="projectbrief">Embedded SDK</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">Embedded SDK</a></li><li class="navelem"><a class="el" href="nbgl_mainpage.html">New BOLOS Graphic API for Stax/Flex</a></li>  </ul>
</div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Predefined pages API </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="nbgl_page_intro"></a>
Introduction</h1>
<p>This chapter describes briefly the high-level API of Advanced BOLOS Graphic Library.</p>
<p>This layer offers a simplified view of a screen page, using predefined pages, like a consent page for example.</p>
<p>A full description of each predefined page can be found in this document</p>
<h1><a class="anchor" id="nbgl_page_concepts"></a>
Concepts</h1>
<p>This layer uses the mid-level API described in <a class="el" href="nbgl_layout.html">Complex objects layout API</a>, but all objects are hidden, in favor to fields to configure, for example texts, icons, tokens for callbacks.</p>
<p>Moreover, positions of objects in the page are mostly hidden and automatic.</p>
<h2><a class="anchor" id="nbgl_page_example_1"></a>
Example 1</h2>
<p><img src="page1.png" alt="" height="300" class="inline" title="caption"/></p>
<p>In this example, a generic information page is used with some configurable fields:</p>
<ul>
<li>Top-right button icon type and token when touched</li>
<li>Centered information icon, main text and possibly a subsidiary text under it.</li>
<li>Centered-bottom button icon type and token when touched</li>
</ul>
<h2><a class="anchor" id="nbgl_page_example_2"></a>
Example 2</h2>
<p><img src="page2.png" alt="" height="300" class="inline" title="caption"/></p>
<p>In this more complex example, we use a multi-pages configuration. In this configuration, we decided to use the navigation between pages by "tapping" on container to go forward, use the "Back" arrow in progress indicator (top-left of the page) to go backward, and footer to exit navigation.</p>
<p>In the "tapable" container, we use a content of type <a class="el" href="nbgl__content_8h.html#a9010d75a386dacb48d7a31667d7cf203a2b62aad3b320b6e0073e7be25da19a72">INFO_LONG_PRESS</a>, containing a centered info and a long-press button.</p>
<h1><a class="anchor" id="nbgl_page_operations"></a>
Operations</h1>
<h2><a class="anchor" id="create_page"></a>
Draw a predefined page</h2>
<p>The configuration of a page is provided in a single function call, and all predefined pages APIs will do the following operations:</p>
<ul>
<li>Create the page</li>
<li>Add required complex objects in the page</li>
<li>Draw the objects in the <b>framebuffer</b></li>
</ul>
<p>A few APIs are available to draw typical pages, like:</p>
<ul>
<li><a class="el" href="nbgl__page_8h.html#a8c337b8ce7a2657a4380f7dbd01edff8">nbgl_pageDrawLedgerInfo()</a> to draw a simple centered text in a center info in large case, with a round check icon (typically to provide the status of an action)</li>
<li><a class="el" href="nbgl__page_8h.html#a90f5a6e0c62d09fb2286181583c0833d">nbgl_pageDrawSpinner()</a> to draw a spinner (typically a waiting screen)</li>
<li><a class="el" href="nbgl__page_8h.html#a5ac6958a9695e2c97d7519551488d12c">nbgl_pageDrawInfo()</a> to draw a centered info with potential footer (or bottom button), "tapable" container and top-right button</li>
<li><a class="el" href="nbgl__page_8h.html#ac0d8ef3da7de84fe078fcf2a13cc931e">nbgl_pageDrawConfirmation()</a> to draw a typical confirmation screen, for example when rejecting a transaction (with 1 button for confirmation)</li>
</ul>
<p>In addition, in order to factorize some code, a generic function is available to draw generic content, either for a single page or for a multi-pages configuration.</p>
<ul>
<li><a class="el" href="nbgl__page_8h.html#a4ad845ddc37c85c569bd5a39e87f6c06">nbgl_pageDrawGenericContent()</a></li>
</ul>
<h2><a class="anchor" id="page_typical_types"></a>
Typical page types</h2>
<h3><a class="anchor" id="page_ledger_info"></a>
Ledger information</h3>
<p><img src="page3.png" alt="" height="300" class="inline" title="caption"/></p>
<p>This type is intended to draw a simple centered text in large case, with a round check icon (typically to provide the status of an action)</p>
<p>The API to insert such an object is <a class="el" href="nbgl__page_8h.html#a8c337b8ce7a2657a4380f7dbd01edff8">nbgl_pageDrawLedgerInfo()</a> with:</p>
<ul>
<li>The text to draw in centered info</li>
<li>A potential ticker configuration.</li>
</ul>
<h3><a class="anchor" id="page_spinner"></a>
Spinner</h3>
<p><img src="page4.png" alt="" height="300" class="inline" title="caption"/></p>
<p>This type is intended to to draw a spinner (typically a waiting screen)</p>
<p>The API to insert such an object is <a class="el" href="nbgl__page_8h.html#a90f5a6e0c62d09fb2286181583c0833d">nbgl_pageDrawSpinner()</a> with:</p>
<ul>
<li>The text to draw.</li>
</ul>
<h3><a class="anchor" id="page_info"></a>
Generic information</h3>
<p><img src="page_drawInfo1.png" alt="" height="300" class="inline" title="caption"/></p>
<p>This type is intended to draw a centered info. In addition of this centered info, this page can offer controls to interact with the info:</p>
<ul>
<li>A potential footer or bottom button</li>
<li>A potential "tapable" container</li>
<li>A potential top-right button</li>
</ul>
<p>The API to insert such an object is <a class="el" href="nbgl__page_8h.html#a5ac6958a9695e2c97d7519551488d12c">nbgl_pageDrawInfo()</a> with the <a class="el" href="nbgl__page_8h.html#a1d545e2ba481ea35574a1b0c8df7fb01">nbgl_pageInfoDescription_t</a> structure, containing:</p>
<ul>
<li>The text and token to use for a footer.</li>
<li>The icon and token to use for a bottom button.</li>
<li>The icon and token to use for a top-right button.</li>
<li>The centered information parameters (icon, text, sub-text...).</li>
</ul>
<p>An optional "action" button can also be displayed for the following case:</p>
<p><img src="page_drawInfo2.png" alt="" height="300" class="inline" title="caption"/></p>
<p>In this case, the <b>actionButtonText</b> field of <a class="el" href="nbgl__page_8h.html#a1d545e2ba481ea35574a1b0c8df7fb01">nbgl_pageInfoDescription_t</a> can be used, and <b>bottomButtonsToken</b> is used in <b>actionCallback</b> param, with <b>index</b> = 0 for action button, and <b>index</b> = 1 for quit button.</p>
<h3><a class="anchor" id="page_confirmation"></a>
Confirmation page</h3>
<p><img src="page6.png" alt="" height="300" class="inline" title="caption"/></p>
<p>This type is intended to draw a typical confirmation screen, for example when rejecting a transaction (with 1 button for confirmation). In addition of a centered info, this page offer control to interact with the info:</p>
<ul>
<li>A bottom button to cancel</li>
<li>A single button to confirm</li>
</ul>
<p>The API to insert such an object is <a class="el" href="nbgl__page_8h.html#ac0d8ef3da7de84fe078fcf2a13cc931e">nbgl_pageDrawConfirmation()</a> with the <a class="el" href="nbgl__page_8h.html#ac66976939464e1de19d533e125ae01a1">nbgl_pageConfirmationDescription_t</a> structure, containing:</p>
<ul>
<li>The text and token to use for the confirmation button.</li>
<li>The text and token to use for the bottom button.</li>
<li>The centered information parameters (icon, text, sub-text...).</li>
</ul>
<h2><a class="anchor" id="page_generic_types"></a>
Generic content pages</h2>
<h3><a class="anchor" id="page_generic_content"></a>
Generic content types</h3>
<p>The different types of generic content are given in <a class="el" href="nbgl__content_8h.html#a9010d75a386dacb48d7a31667d7cf203">nbgl_contentType_t</a> enumeration.</p>
<ul>
<li><a class="el" href="nbgl__content_8h.html#a9010d75a386dacb48d7a31667d7cf203a9d1cb6345b68a3b110bf826fd702dcc1">CENTERED_INFO</a> is used to draw a centered info. The structure containing data to build it is <a class="el" href="structnbgl__contentCenteredInfo__t.html">nbgl_contentCenteredInfo_t</a></li>
<li><a class="el" href="nbgl__content_8h.html#a9010d75a386dacb48d7a31667d7cf203a2b62aad3b320b6e0073e7be25da19a72">INFO_LONG_PRESS</a> is used to draw a centered info and a long press button. The structure containing data to build it is <a class="el" href="structnbgl__contentInfoLongPress__t.html">nbgl_contentInfoLongPress_t</a></li>
<li><a class="el" href="nbgl__content_8h.html#a9010d75a386dacb48d7a31667d7cf203af4924e029416352949b8726ad12153e1">INFO_BUTTON</a> is used to draw a centered info and a simple black button. The structure containing data to build it is <a class="el" href="structnbgl__contentInfoButton__t.html">nbgl_contentInfoButton_t</a></li>
<li><a class="el" href="nbgl__content_8h.html#a9010d75a386dacb48d7a31667d7cf203ad4992814ce29d2a2b131464f0b72523c">TAG_VALUE_LIST</a> is used to draw alist of tag/value pairs. The structure containing data to build it is <a class="el" href="structnbgl__contentTagValueList__t.html">nbgl_contentTagValueList_t</a></li>
</ul>
<p><img src="page15.png" alt="" height="300" class="inline" title="caption"/></p>
<p>The <b>smallCaseForValue</b> field is used to indicate whether to use a 32px (false) or 24px (true) font for <b>value</b> text. Normally, the small font is supposed to be used only to display details.</p>
<ul>
<li><a class="el" href="nbgl__content_8h.html#a9010d75a386dacb48d7a31667d7cf203abb05cc39dd23d667f6ad41643f0d8986">TAG_VALUE_DETAILS</a> is used to draw a tag/value pair and a small button to get details on it. The structure containing data to build it is <a class="el" href="structnbgl__contentTagValueDetails__t.html">nbgl_contentTagValueDetails_t</a></li>
</ul>
<p><img src="page14.png" alt="" height="300" class="inline" title="caption"/></p>
<p>The "details" button is only displayed if the <b>value</b> text is longer than 9 lines. And in this case, the <b>value</b> text is truncated at the 6th line, and "..." is used to show that the text is truncated.</p>
<ul>
<li><a class="el" href="nbgl__content_8h.html#a9010d75a386dacb48d7a31667d7cf203ad419fc4ece093d828de4b8295ccb0164">TAG_VALUE_CONFIRM</a> is used to draw tag/value pairs and a potential confirmation button in the same page. The structure containing data to build it is <a class="el" href="structnbgl__contentTagValueConfirm__t.html">nbgl_contentTagValueConfirm_t</a></li>
</ul>
<p><img src="page-TagValueConfirm.png" alt="" height="300" class="inline" title="caption"/></p>
<p>The "details" button is only displayed if the <b>detailsButtonText</b> is not NULL.</p>
<ul>
<li><a class="el" href="nbgl__content_8h.html#a9010d75a386dacb48d7a31667d7cf203aaa3b4a61cc5be5e90bd2c1ab32f13373">SWITCHES_LIST</a> is used to draw a list of switches with descriptions. The structure containing data to build it is <a class="el" href="nbgl__content_8h.html#a1e9fa82698f1cb79be7824591c133f41">nbgl_contentSwitchesList_t</a></li>
</ul>
<p><img src="page16.png" alt="" height="300" class="inline" title="caption"/></p>
<ul>
<li><a class="el" href="nbgl__content_8h.html#a9010d75a386dacb48d7a31667d7cf203ad372699e9303e56cf4622a00eea34032">INFOS_LIST</a> is used to draw a list of infos with titles. The structure containing data to build it is <a class="el" href="structnbgl__contentInfoList__t.html">nbgl_contentInfoList_t</a></li>
</ul>
<p><img src="page13.png" alt="" height="300" class="inline" title="caption"/></p>
<ul>
<li><a class="el" href="nbgl__content_8h.html#a9010d75a386dacb48d7a31667d7cf203a9688daa58ea35451ae316f87bb10d705">CHOICES_LIST</a> is used to draw a list of choices through radio buttons. The structure containing data to build it is <a class="el" href="structnbgl__contentRadioChoice__t.html">nbgl_contentRadioChoice_t</a></li>
</ul>
<p><img src="page11.png" alt="" height="300" class="inline" title="caption"/></p>
<ul>
<li><a class="el" href="nbgl__content_8h.html#a9010d75a386dacb48d7a31667d7cf203ad7c24dba039a29d3a48a1178f59199d0">BARS_LIST</a> is used to draw a list of touchable bars (with &gt; on the right to go to sub-pages). The structure containing data to build it is <a class="el" href="structnbgl__contentBarsList__t.html">nbgl_contentBarsList_t</a></li>
</ul>
<p><img src="page17.png" alt="" height="300" class="inline" title="caption"/></p>
<h3><a class="anchor" id="page_generic_single"></a>
Generic content page API</h3>
<p>This type is intended to draw generic content for single or multi-pages, with an optional way to navigate. It doesn't directly manage the different pages, but it provides control to draw a new page when the navigation is used.</p>
<p>The API to create such a page is <a class="el" href="nbgl__page_8h.html#a4ad845ddc37c85c569bd5a39e87f6c06">nbgl_pageDrawGenericContent()</a>.</p>
<ul>
<li>The first parameter provides the action callback (for all controls)</li>
<li>The second one, if not NULL, provides the navigation parameters (see next chapter)</li>
<li>The last one provides the content of the page itself</li>
</ul>
<h3><a class="anchor" id="page_generic_navigation"></a>
Generic content page navigation</h3>
<p>When used in a multi-pages configuration, the developer must provide a way to navigate between pages.</p>
<p>There are two main possibilities, with extra-options:</p>
<ul>
<li>Either with a navigation bar on the bottom on the screen (if <b>navType</b> field of <a class="el" href="nbgl__page_8h.html#a8295ae1ca9b3d1e78c74f9d46fa4900a">nbgl_pageNavigationInfo_t</a> is set to <a class="el" href="nbgl__page_8h.html#a8173f6838d99e7da5e51a7be6e822bcba057d896bfb6345f828a4dc5e52b57c1a">NAV_WITH_BUTTONS</a>)</li>
<li>Or with a tapable container and back button in progress indicator (if <b>navType</b> field of <a class="el" href="nbgl__page_8h.html#a8295ae1ca9b3d1e78c74f9d46fa4900a">nbgl_pageNavigationInfo_t</a> is set to <a class="el" href="nbgl__page_8h.html#a8173f6838d99e7da5e51a7be6e822bcbae82477b7d8c57e00c1258a80a5a543c3">NAV_WITH_TAP</a>)</li>
</ul>
<p><u>Navigation with buttons in bottom bar:</u></p>
<p>In this case, all specific parameters can be found in <a class="el" href="nbgl__page_8h.html#a00defa4d525075e47413e75c640d1cc4">nbgl_pageNavWithButtons_t</a> :</p>
<ul>
<li>The navigation token used when pressing back (left) or forward (right) buttons.</li>
<li>A boolean to decide whether a Quit button (X) is used in addition of navigation buttons (in this case, the token value is <a class="el" href="nbgl__layout_8h.html#ae328b0b46fb693acca2bdab2213a4b1d">EXIT_PAGE</a>)</li>
</ul>
<p><u>Navigation with "tap":</u></p>
<p>In this case, all specific parameters can be found in <a class="el" href="nbgl__page_8h.html#a6d507b1f37dcaaad48f5bb75faead60a">nbgl_pageNavWithTap_t</a> :</p>
<ul>
<li>a boolean to decide whether a back button (left arrow) is displayed in the top left corner (if page &gt;=1)</li>
<li>a token attached to this potential back button</li>
<li>a text used as indication for "Tap to continue", to navigate forward</li>
<li>a token used as argument of the action callback when the main container is "taped"</li>
<li>the main text displayed in footer, used to quit. If NULL, no footer to quit.</li>
<li>the second text displayed in footer (on the right), used to skip. If NULL, only main text is displayed</li>
<li>a token used as argument of the action callback when the second text displayed in footer is touched</li>
</ul>
<p><u>Common parameters:</u></p>
<p>Some navigation parameters are common to both types:</p>
<ul>
<li>the index of the page to display at start-up (from 0 to (nb_pages-1))</li>
<li>the number of pages to display (if &lt;2, no navigation bar)</li>
<li>the token used as argument of the action callback when the footer or the quit (X) button is touched</li>
<li>a boolean to display a progress indicator on top of the page or not</li>
</ul>
<h2><a class="anchor" id="page_refresh_page"></a>
Refreshing screen</h2>
<p>After having drawn graphic objects in <b>framebuffer</b>, it is necessary to transfer the content of the <b>framebuffer</b> on display. This operation is called a refresh.</p>
<p>The API to do that is <a class="el" href="nbgl__obj_8h.html#a2c321e01f64784c5249e594b795bf252">nbgl_refresh()</a> (in <a class="el" href="nbgl__obj_8h.html" title="API to draw all basic graphic objects.">nbgl_obj.h</a>)</p>
<p>It will only refresh the rectangle part of the screen having changed (with objects redrawn) since the last refresh.</p>
<h2><a class="anchor" id="page_callbacks"></a>
Control actions management</h2>
<p>Some controls, like touchable bars, or a choice by radio buttons, can be interacted with thanks to the Touchscreen.</p>
<p>The developer can subscribe to these events by providing an action callback in <a class="el" href="nbgl__layout_8h.html#a9ff89401d84106e775567a11c40769b7">nbgl_layoutGet()</a>, with <a class="el" href="nbgl__layout_8h.html#a01348bb7cb5aebd69dcf87806ea58aa7">nbgl_layoutTouchCallback_t</a> prototype.</p>
<p>The first parameter (<em>token</em>) of this function is a token provided along with the definition of the complex object.</p>
<p>The second parameter (<em>index</em>) is only used for some types of complex objects:</p>
<ul>
<li><b>Navigation bar</b>: in this case, <em>index</em> gives the index of the new active page, when navigating (or <a class="el" href="nbgl__layout_8h.html#ae328b0b46fb693acca2bdab2213a4b1d">EXIT_PAGE</a> when quit button is pressed).</li>
<li><b>Radio buttons choice</b>: in this case, <em>index</em> gives the index of the selected choice.</li>
<li><b>Switches</b>: in this case, if <em>index</em> is 0 it means OFF, otherwise it means ON.</li>
</ul>
<h2><a class="anchor" id="page_release"></a>
Releasing a predefined page</h2>
<p>Before leaving a screen built with a layout, it must be released with a call to <a class="el" href="nbgl__page_8h.html#ae8c3ee5a762b720bf0b87e34448da6fd">nbgl_pageRelease()</a>. It will free the allocated objects. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
