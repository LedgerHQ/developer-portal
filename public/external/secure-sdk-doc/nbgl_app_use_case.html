<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Embedded SDK: Predefined Application Use-cases API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Embedded SDK
   </div>
   <div id="projectbrief">Embedded SDK</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">Embedded SDK</a></li><li class="navelem"><a class="el" href="nbgl_mainpage.html">New BOLOS Graphic API for Stax/Flex</a></li>  </ul>
</div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Predefined Application Use-cases API </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="nbgl_use_case_intro"></a>
Introduction</h1>
<p>This chapter describes the Application Use-cases API of Advanced BOLOS Graphic Library.</p>
<p>This layer offers a simplified view of some typical use-cases of display in an Application running on Stax. For example, a use-case can be:</p>
<ul>
<li>Reviewing a transaction/message</li>
<li>Reviewing details on a given data of a transaction/message</li>
<li>Displaying pages of settings</li>
</ul>
<p>A full description of each predefined use-case can be found in this document</p>
<h1><a class="anchor" id="nbgl_use_case_concepts"></a>
Concepts</h1>
<p>This layer uses the high-level API described in <a class="el" href="nbgl_page.html">Predefined pages API</a>, but offers to developer more than a single page.</p>
<p>The goal is to simplify the usage of NBGL, but also to offer a better homogeneity across applications, by pushing developers to use common API for common use-cases.</p>
<p>So that not only the look of the pages but also their transitions look the same. Which should be a real help for end-users, getting more and more familiar with the user experience of applications.</p>
<h2><a class="anchor" id="nbgl_use_case_example_1"></a>
Example 1: transaction review</h2>
<p><img src="UseCase-Review.png" alt="" height="300" class="inline" title="caption"/></p>
<p>In this example, a transaction review consists in 3 successive pages, and can be seen as a use-case</p>
<h2><a class="anchor" id="nbgl_use_case_example_2"></a>
Example 2: home &amp; settings pages</h2>
<p><img src="UseCase-HomeSettings.png" alt="" height="300" class="inline" title="caption"/></p>
<p>In this other example, displaying home page, then the settings and info consists in 3 pages, and can be seen as another use-case.</p>
<h1><a class="anchor" id="nbgl_use_cases"></a>
Use Cases</h1>
<p>A few APIs are available to draw typical Use-Cases, such as:</p>
<ul>
<li>for Home Screen &amp; Settings:<ul>
<li><a class="el" href="nbgl__use__case_8h.html#a438078d9be71706e0ad6a05f56658255">nbgl_useCaseHomeAndSettings()</a> to draw the home page and settings/info pages (see <a class="el" href="nbgl_app_use_case.html#use_case_home_settings">Home &amp; Settings screen Use Case</a>)</li>
</ul>
</li>
<li>for Individual pages:<ul>
<li><a class="el" href="nbgl__use__case_8h.html#a6f689a2dbefa1dd38cff6174bb214b72">nbgl_useCaseConfirm()</a> to draw a typical confirmation page, for example when rejecting a transaction (see <a class="el" href="nbgl_app_use_case.html#use_case_confirm">Confirmation Use Case</a>)</li>
<li><a class="el" href="nbgl__use__case_8h.html#aafc860c31b7c91be7e22adc79f9b21a5">nbgl_useCaseChoice()</a> to draw a typical dual choice page (see <a class="el" href="nbgl_app_use_case.html#use_case_choice">Choice Use Case</a>)</li>
<li><a class="el" href="nbgl__use__case_8h.html#a8eebd5b1e53a4894c4c05ddae49c8ae8">nbgl_useCaseStatus()</a> to draw a transient status page, without control, for example when a transaction is successfully signed (see <a class="el" href="nbgl_app_use_case.html#use_case_status">Status Use Case</a>)</li>
<li><a class="el" href="nbgl__use__case_8h.html#a6c70e8409832531cb83c75c5c376ee18">nbgl_useCaseSpinner()</a> to draw an infinite spinner page (see <a class="el" href="nbgl_app_use_case.html#use_case_spinner">Spinner Use Case</a>)</li>
</ul>
</li>
<li>for most used reviews:<ul>
<li><a class="el" href="nbgl__use__case_8h.html#a303e3242b26535f74695f94a51d8cb6a">nbgl_useCaseReview()</a> to draw the pages of a regular coin transaction review, when all info are available from the beginning (see <a class="el" href="nbgl_app_use_case.html#use_case_review">Review Use Case</a>)</li>
<li><a class="el" href="nbgl__use__case_8h.html#adb0805a5c32e8515c0e36ecd856f1a40">nbgl_useCaseReviewLight()</a> to draw the pages of a transaction review with a simple button confirmation, when all info are available from the beginning (see <a class="el" href="nbgl_app_use_case.html#use_case_review_light">Light review Use Case</a>)</li>
<li><a class="el" href="nbgl__use__case_8h.html#a42b9838f8e87318f142b4bfa11cd8e1a">nbgl_useCaseReviewStreamingStart()</a> to draw the pages of a regular coin transaction review, when all info are not available from the beginning (see <a class="el" href="nbgl_app_use_case.html#use_case_review_streaming">Streaming review Use Case</a>)</li>
</ul>
</li>
<li>for address verification:<ul>
<li><a class="el" href="nbgl__use__case_8h.html#af488f6a96b0c702f31cca21ff5276663">nbgl_useCaseAddressReview()</a> to draw an address confirmation page, with a possibility to see it as QR Code and some extra tag/value pairs (see <a class="el" href="nbgl_app_use_case.html#use_case_addr_review">Address Review Use Case</a>)</li>
</ul>
</li>
<li>for keypad:<ul>
<li><a class="el" href="nbgl__use__case_8h.html#a29799c89a1e92963706ffc97ceee9d5a">nbgl_useCaseKeypadPIN()</a> to draw a default keypad implementation with hidden digits (see <a class="el" href="nbgl_app_use_case.html#use_case_keypad">Keypad Use Case</a>)</li>
<li><a class="el" href="nbgl__use__case_8h.html#a89212f593a06326783ee901b62d21492">nbgl_useCaseKeypadDigits()</a> to draw a default keypad implementation, showing digits (see <a class="el" href="nbgl_app_use_case.html#use_case_keypad">Keypad Use Case</a>)</li>
</ul>
</li>
<li>for generic navigable content:<ul>
<li><a class="el" href="nbgl__use__case_8h.html#a59ad76a085182d27f1a15422a1598de0">nbgl_useCaseNavigableContent()</a> to draw a level of generic content navigable pages</li>
</ul>
</li>
</ul>
<p>Some APIs have also been kept for backward compatibility, and for some rare cases:</p>
<ul>
<li>for most used reviews:<ul>
<li><a class="el" href="nbgl__use__case_8h.html#a728cc81c77011fb0e51a6e73d15a8e8b">nbgl_useCaseReviewStart()</a> to draw the cover page of a review (initial page, without data)</li>
<li><a class="el" href="nbgl__use__case_8h.html#ac85bc83d4448aa62ec57eed4bf8d1bd0">nbgl_useCaseStaticReview()</a> to draw the data pages of a regular review, when all info are available from the beginning (all pages but the cover one)</li>
<li><a class="el" href="nbgl__use__case_8h.html#ac092f1759210d1ea0fc23754043fcdf0">nbgl_useCaseRegularReview()</a> to draw the data pages of a regular review (all pages but the cover one)</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="use_case_home_settings"></a>
Home &amp; Settings screen Use Case</h2>
<p><img src="UseCase-HomeSettingsAPI.png" alt="" height="300" class="inline" title="caption"/></p>
<p>Ledger would like all application to have the same layout for home screen and settings/info, so the <a class="el" href="nbgl__use__case_8h.html#a438078d9be71706e0ad6a05f56658255">nbgl_useCaseHomeAndSettings()</a> function enables to create such a set of page, the configurable parameters being:</p>
<ul>
<li>the application name (appName)</li>
<li>the application icon (appIcon)</li>
<li>the tagline, a text under app name (if NULL, it will be "This app enables signing transactions on the &lt;appName&gt; network.")</li>
<li>the callback when touching <em>quit application</em> button</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">extern</span> <span class="keyword">const</span> <a class="code hl_typedef" href="nbgl__types_8h.html#a7724587bc3e14c498ed49c3e70c365d6">nbgl_icon_details_t</a> *eth_icon;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">enum</span> {</div>
<div class="line">    SWITCH1_TOKEN = <a class="code hl_define" href="nbgl__use__case_8h.html#ab17d3c66e783f1a3b425e9b4ee41615c">FIRST_USER_TOKEN</a>,</div>
<div class="line">    SWITCH2_TOKEN</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <a class="code hl_struct" href="structnbgl__contentSwitch__t.html">nbgl_layoutSwitch_t</a> switches[] = {</div>
<div class="line">    {.<a class="code hl_variable" href="structnbgl__contentSwitch__t.html#aaaf0670e644a56f10c4675debcddddee">initState</a> = <span class="keyword">false</span>,</div>
<div class="line">     .text      = <span class="stringliteral">&quot;ENS addresses&quot;</span>,</div>
<div class="line">     .subText   = <span class="stringliteral">&quot;Displays the resolved address of ENS domains.&quot;</span>,</div>
<div class="line">     .token     = SWITCH1_TOKEN,</div>
<div class="line">     .tuneId    = TUNE_TAP_CASUAL},</div>
<div class="line">    {.initState = <span class="keyword">true</span>,</div>
<div class="line">     .text      = <span class="stringliteral">&quot;Raw messages&quot;</span>,</div>
<div class="line">     .subText   = <span class="stringliteral">&quot;Displays raw content from EIP712 messages.&quot;</span>,</div>
<div class="line">     .token     = SWITCH2_TOKEN,</div>
<div class="line">     .tuneId    = TUNE_TAP_CASUAL}</div>
<div class="line">};</div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *infoTypes[]    = {<span class="stringliteral">&quot;Version&quot;</span>, <span class="stringliteral">&quot;Developer&quot;</span>};</div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *infoContents[] = {<span class="stringliteral">&quot;1.9.18&quot;</span>, <span class="stringliteral">&quot;Ledger&quot;</span>};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// function called in case of action on switches</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> controlsCallback(<span class="keywordtype">int</span> token, <a class="code hl_typedef" href="usbd__conf_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> index, <span class="keywordtype">int</span> page) {</div>
<div class="line">  <span class="keywordflow">if</span> (token == SWITCH1_TOKEN) {</div>
<div class="line">    <span class="keywordflow">if</span> (index == 0) {</div>
<div class="line">      <span class="comment">// deactivate something related with ENS</span></div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="comment">// activate something related with ENS</span></div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (token == SWITCH2_TOKEN) {</div>
<div class="line">    <span class="keywordflow">if</span> (index == 0) {</div>
<div class="line">      <span class="comment">// deactivate something related with EIP712</span></div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="comment">// activate something related with EIP712</span></div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <a class="code hl_struct" href="structnbgl__content__t.html">nbgl_content_t</a> contentsList = {</div>
<div class="line">  .<a class="code hl_variable" href="structnbgl__content__t.html#a1ac1044cc537f7fe43b304cbc0202061">content</a>.<a class="code hl_variable" href="unionnbgl__content__u.html#abc36dfa9d42e152185ac985e42b69bde">switchesList</a>.<a class="code hl_variable" href="structnbgl__pageSwitchesList__s.html#a1036d245c6954223009c4706a15a0ef0">nbSwitches</a> = 2,</div>
<div class="line">  .content.switchesList.switches = switches,</div>
<div class="line">  .type = <a class="code hl_enumvalue" href="nbgl__content_8h.html#a9010d75a386dacb48d7a31667d7cf203aaa3b4a61cc5be5e90bd2c1ab32f13373">SWITCHES_LIST</a>,</div>
<div class="line">  .contentActionCallback = controlsCallback</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <a class="code hl_struct" href="structnbgl__genericContents__t.html">nbgl_genericContents_t</a> eth_settingContents</div>
<div class="line">    = {.<a class="code hl_variable" href="structnbgl__genericContents__t.html#a5cca760808bb3ea7c33585b5a44f7e56">contentsList</a> = &amp;contentsList, .nbContents = 1};</div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <a class="code hl_struct" href="structnbgl__contentInfoList__t.html">nbgl_contentInfoList_t</a> eth_infosList</div>
<div class="line">    = {.<a class="code hl_variable" href="structnbgl__contentInfoList__t.html#a793d32bf132778456d9d34c77f24fce8">nbInfos</a> = 2, .infoTypes = infoTypes, .infoContents = infoContents};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> onQuit(<span class="keywordtype">void</span>) {</div>
<div class="line">    <span class="comment">// exit app here</span></div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> appMain(<span class="keywordtype">void</span>) {</div>
<div class="line">    <a class="code hl_function" href="nbgl__use__case_8h.html#a438078d9be71706e0ad6a05f56658255">nbgl_useCaseHomeAndSettings</a>(<span class="stringliteral">&quot;Ethereum&quot;</span>,</div>
<div class="line">                                eth_icon,</div>
<div class="line">                                NULL,                  <span class="comment">// use default tag line</span></div>
<div class="line">                                <a class="code hl_define" href="nbgl__use__case_8h.html#a9cd8c314ebe1bb0c9ebb1a230a61fcb9">INIT_HOME_PAGE</a>,        <span class="comment">// start at home page</span></div>
<div class="line">                                &amp;eth_settingContents,  <span class="comment">// description of settings</span></div>
<div class="line">                                &amp;eth_infosList,        <span class="comment">// description of app info</span></div>
<div class="line">                                NULL,                  <span class="comment">// no action button on home screen</span></div>
<div class="line">                                onQuit);               <span class="comment">// when quitting</span></div>
<div class="line">}</div>
<div class="ttc" id="anbgl__content_8h_html_a9010d75a386dacb48d7a31667d7cf203aaa3b4a61cc5be5e90bd2c1ab32f13373"><div class="ttname"><a href="nbgl__content_8h.html#a9010d75a386dacb48d7a31667d7cf203aaa3b4a61cc5be5e90bd2c1ab32f13373">SWITCHES_LIST</a></div><div class="ttdeci">@ SWITCHES_LIST</div><div class="ttdoc">list of switches with descriptions</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__content_8h_source.html#l00348">nbgl_content.h:348</a></div></div>
<div class="ttc" id="anbgl__types_8h_html_a7724587bc3e14c498ed49c3e70c365d6"><div class="ttname"><a href="nbgl__types_8h.html#a7724587bc3e14c498ed49c3e70c365d6">nbgl_icon_details_t</a></div><div class="ttdeci">struct PACKED__ nbgl_icon_details_s nbgl_icon_details_t</div><div class="ttdoc">Represents all information about an icon.</div></div>
<div class="ttc" id="anbgl__use__case_8h_html_a438078d9be71706e0ad6a05f56658255"><div class="ttname"><a href="nbgl__use__case_8h.html#a438078d9be71706e0ad6a05f56658255">nbgl_useCaseHomeAndSettings</a></div><div class="ttdeci">void nbgl_useCaseHomeAndSettings(const char *appName, const nbgl_icon_details_t *appIcon, const char *tagline, const uint8_t initSettingPage, const nbgl_genericContents_t *settingContents, const nbgl_contentInfoList_t *infosList, const nbgl_homeAction_t *action, nbgl_callback_t quitCallback)</div></div>
<div class="ttc" id="anbgl__use__case_8h_html_a9cd8c314ebe1bb0c9ebb1a230a61fcb9"><div class="ttname"><a href="nbgl__use__case_8h.html#a9cd8c314ebe1bb0c9ebb1a230a61fcb9">INIT_HOME_PAGE</a></div><div class="ttdeci">#define INIT_HOME_PAGE</div><div class="ttdoc">Value to pass to nbgl_useCaseHomeAndSettings() initSettingPage parameter to initialize the use case o...</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__use__case_8h_source.html#l00097">nbgl_use_case.h:97</a></div></div>
<div class="ttc" id="anbgl__use__case_8h_html_ab17d3c66e783f1a3b425e9b4ee41615c"><div class="ttname"><a href="nbgl__use__case_8h.html#ab17d3c66e783f1a3b425e9b4ee41615c">FIRST_USER_TOKEN</a></div><div class="ttdeci">#define FIRST_USER_TOKEN</div><div class="ttdoc">when using controls in page content (nbgl_pageContent_t), this is the first token value usable for th...</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__use__case_8h_source.html#l00032">nbgl_use_case.h:32</a></div></div>
<div class="ttc" id="astructnbgl__contentInfoList__t_html"><div class="ttname"><a href="structnbgl__contentInfoList__t.html">nbgl_contentInfoList_t</a></div><div class="ttdoc">This structure contains data to build a INFOS_LIST content.</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__content_8h_source.html#l00268">nbgl_content.h:268</a></div></div>
<div class="ttc" id="astructnbgl__contentInfoList__t_html_a793d32bf132778456d9d34c77f24fce8"><div class="ttname"><a href="structnbgl__contentInfoList__t.html#a793d32bf132778456d9d34c77f24fce8">nbgl_contentInfoList_t::nbInfos</a></div><div class="ttdeci">uint8_t nbInfos</div><div class="ttdoc">number of elements in infoTypes and infoContents array</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__content_8h_source.html#l00274">nbgl_content.h:274</a></div></div>
<div class="ttc" id="astructnbgl__contentSwitch__t_html"><div class="ttname"><a href="structnbgl__contentSwitch__t.html">nbgl_contentSwitch_t</a></div><div class="ttdoc">This structure contains info to build a switch (on the right) with a description (on the left),...</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__content_8h_source.html#l00246">nbgl_content.h:246</a></div></div>
<div class="ttc" id="astructnbgl__contentSwitch__t_html_aaaf0670e644a56f10c4675debcddddee"><div class="ttname"><a href="structnbgl__contentSwitch__t.html#aaaf0670e644a56f10c4675debcddddee">nbgl_contentSwitch_t::initState</a></div><div class="ttdeci">nbgl_state_t initState</div><div class="ttdoc">initial state of the switch</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__content_8h_source.html#l00250">nbgl_content.h:250</a></div></div>
<div class="ttc" id="astructnbgl__content__t_html"><div class="ttname"><a href="structnbgl__content__t.html">nbgl_content_t</a></div><div class="ttdoc">This structure contains data to build a content.</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__content_8h_source.html#l00374">nbgl_content.h:374</a></div></div>
<div class="ttc" id="astructnbgl__content__t_html_a1ac1044cc537f7fe43b304cbc0202061"><div class="ttname"><a href="structnbgl__content__t.html#a1ac1044cc537f7fe43b304cbc0202061">nbgl_content_t::content</a></div><div class="ttdeci">nbgl_content_u content</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__content_8h_source.html#l00376">nbgl_content.h:376</a></div></div>
<div class="ttc" id="astructnbgl__genericContents__t_html"><div class="ttname"><a href="structnbgl__genericContents__t.html">nbgl_genericContents_t</a></div><div class="ttdef"><b>Definition:</b> <a href="nbgl__use__case_8h_source.html#l00145">nbgl_use_case.h:145</a></div></div>
<div class="ttc" id="astructnbgl__genericContents__t_html_a5cca760808bb3ea7c33585b5a44f7e56"><div class="ttname"><a href="structnbgl__genericContents__t.html#a5cca760808bb3ea7c33585b5a44f7e56">nbgl_genericContents_t::contentsList</a></div><div class="ttdeci">const nbgl_content_t * contentsList</div><div class="ttdoc">array of nbgl_content_t (nbContents items).</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__use__case_8h_source.html#l00149">nbgl_use_case.h:149</a></div></div>
<div class="ttc" id="astructnbgl__pageSwitchesList__s_html_a1036d245c6954223009c4706a15a0ef0"><div class="ttname"><a href="structnbgl__pageSwitchesList__s.html#a1036d245c6954223009c4706a15a0ef0">nbgl_pageSwitchesList_s::nbSwitches</a></div><div class="ttdeci">uint8_t nbSwitches</div><div class="ttdoc">number of elements in switches and tokens array</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__content_8h_source.html#l00262">nbgl_content.h:262</a></div></div>
<div class="ttc" id="aunionnbgl__content__u_html_abc36dfa9d42e152185ac985e42b69bde"><div class="ttname"><a href="unionnbgl__content__u.html#abc36dfa9d42e152185ac985e42b69bde">nbgl_content_u::switchesList</a></div><div class="ttdeci">nbgl_contentSwitchesList_t switchesList</div><div class="ttdoc">SWITCHES_LIST type</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__content_8h_source.html#l00365">nbgl_content.h:365</a></div></div>
<div class="ttc" id="ausbd__conf_8h_html_aba7bc1797add20fe3efdf37ced1182c5"><div class="ttname"><a href="usbd__conf_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a></div><div class="ttdeci">unsigned char uint8_t</div><div class="ttdef"><b>Definition:</b> <a href="usbd__conf_8h_source.html#l00053">usbd_conf.h:53</a></div></div>
</div><!-- fragment --><h3><a class="anchor" id="use_case_home_settings_with_action"></a>
Home &amp; Settings screen with action button Use Case</h3>
<p><img src="UseCase-HomeAction.png" alt="" height="300" class="inline" title="caption"/></p>
<p>For some rare applications, one may need an action button in the Home screen, to perform either:</p>
<ul>
<li>The main action of the Application</li>
<li>Or an side-action, as to display an address</li>
</ul>
<p>The <b>action</b> argument of <a class="el" href="nbgl__use__case_8h.html#a438078d9be71706e0ad6a05f56658255">nbgl_useCaseHomeAndSettings()</a> can be used for that. This structure (<a class="el" href="structnbgl__homeAction__t.html">nbgl_homeAction_t</a>) enables to specify:</p>
<ul>
<li>A text &amp; an icon for the button</li>
<li>A function to be called when the button is touched</li>
<li>The type of button (either <a class="el" href="nbgl__use__case_8h.html#a5ad554fa007e5b84e7f3e97bd8070db9ac3e69ff9c29e546ba92ae5aefc96d80f">STRONG_HOME_ACTION</a> for main action, in black, or <a class="el" href="nbgl__use__case_8h.html#a5ad554fa007e5b84e7f3e97bd8070db9a8c3eb2b05d809d549847bb46318fc27e">SOFT_HOME_ACTION</a> for side action, in white)</li>
</ul>
<h2><a class="anchor" id="use_case_confirm"></a>
Confirmation Use Case</h2>
<p><img src="UseCase-Confirm.png" alt="" height="300" class="inline" title="caption"/></p>
<p>A confirmation use-case consists in a single modal page containing a fixed icon, a configurable message, a black button and a footer to make the choice, with configuration texts. The <a class="el" href="nbgl__use__case_8h.html#a6f689a2dbefa1dd38cff6174bb214b72">nbgl_useCaseConfirm()</a> function enables to create such a page.</p>
<p>The <em>callback</em> argument is called when the button is touched.</p>
<p>When the footer is touched, this modal screen is simply dismissed, revealing the previous page on background.</p>
<p>Here is the code to display the example picture (and a status page for confirmation)</p>
<div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> confirmationCallback(<span class="keywordtype">void</span>) {</div>
<div class="line">  <span class="comment">// draw a status screen which continues by returning to appMain</span></div>
<div class="line">  <a class="code hl_function" href="nbgl__use__case_8h.html#a8eebd5b1e53a4894c4c05ddae49c8ae8">nbgl_useCaseStatus</a>(<span class="stringliteral">&quot;Transaction rejected&quot;</span>,<span class="keyword">false</span>,appMain);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> onRejectTransaction(<span class="keywordtype">void</span>) {</div>
<div class="line">  <a class="code hl_function" href="nbgl__use__case_8h.html#a6f689a2dbefa1dd38cff6174bb214b72">nbgl_useCaseConfirm</a>(<span class="stringliteral">&quot;Reject transaction?&quot;</span>,<span class="stringliteral">&quot;Yes, Reject&quot;</span>,<span class="stringliteral">&quot;Go back to transaction&quot;</span>,confirmationCallback);</div>
<div class="line">}</div>
<div class="ttc" id="anbgl__use__case_8h_html_a6f689a2dbefa1dd38cff6174bb214b72"><div class="ttname"><a href="nbgl__use__case_8h.html#a6f689a2dbefa1dd38cff6174bb214b72">nbgl_useCaseConfirm</a></div><div class="ttdeci">void nbgl_useCaseConfirm(const char *message, const char *subMessage, const char *confirmText, const char *rejectText, nbgl_callback_t callback)</div></div>
<div class="ttc" id="anbgl__use__case_8h_html_a8eebd5b1e53a4894c4c05ddae49c8ae8"><div class="ttname"><a href="nbgl__use__case_8h.html#a8eebd5b1e53a4894c4c05ddae49c8ae8">nbgl_useCaseStatus</a></div><div class="ttdeci">void nbgl_useCaseStatus(const char *message, bool isSuccess, nbgl_callback_t quitCallback)</div></div>
</div><!-- fragment --><h2><a class="anchor" id="use_case_choice"></a>
Choice Use Case</h2>
<p><img src="UseCase-Choice.png" alt="" height="300" class="inline" title="caption"/></p>
<p>A choice use-case consists in a single page containing a fixed icon, a configurable icon, a configurable message, a black button and a footer to make the choice, with configuration texts. The <a class="el" href="nbgl__use__case_8h.html#aafc860c31b7c91be7e22adc79f9b21a5">nbgl_useCaseChoice()</a> function enables to create such a page.</p>
<p>The <em>callback</em> argument is called when the button or the footer is touched. Its argument is a boolean which is <em>true</em> when button is touched, <em>false</em> when footer is touched.</p>
<p>Here is the code to display the example picture</p>
<div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> onChoice(<span class="keywordtype">bool</span> confirm) {</div>
<div class="line">  <span class="keywordflow">if</span> (confirm) {</div>
<div class="line">    <span class="comment">// do something on button touch</span></div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="comment">// do something on footer touch</span></div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> onRejectTransaction(<span class="keywordtype">void</span>) {</div>
<div class="line">  <a class="code hl_function" href="nbgl__use__case_8h.html#aafc860c31b7c91be7e22adc79f9b21a5">nbgl_useCaseChoice</a>(&amp;C_key_64px,</div>
<div class="line">                     <span class="stringliteral">&quot;Delete all credentials?&quot;</span>,</div>
<div class="line">                     <span class="stringliteral">&quot;This includes all saved\ncredentials from all websites\nand services.&quot;</span>,</div>
<div class="line">                     <span class="stringliteral">&quot;Yes, erase&quot;</span>,<span class="stringliteral">&quot;No, don&#39;t erase&quot;</span>,</div>
<div class="line">                     onChoice);</div>
<div class="line">}</div>
<div class="ttc" id="anbgl__use__case_8h_html_aafc860c31b7c91be7e22adc79f9b21a5"><div class="ttname"><a href="nbgl__use__case_8h.html#aafc860c31b7c91be7e22adc79f9b21a5">nbgl_useCaseChoice</a></div><div class="ttdeci">void nbgl_useCaseChoice(const nbgl_icon_details_t *icon, const char *message, const char *subMessage, const char *confirmText, const char *rejectString, nbgl_choiceCallback_t callback)</div></div>
</div><!-- fragment --><h2><a class="anchor" id="use_case_status"></a>
Status Use Case</h2>
<p><img src="UseCase-Status.png" alt="" height="300" class="inline" title="caption"/></p>
<p>A status is a transient page, without control, to display during a short time, for example when a transaction is successfully signed. The <a class="el" href="nbgl__use__case_8h.html#a8eebd5b1e53a4894c4c05ddae49c8ae8">nbgl_useCaseStatus()</a> function enables to create such a page, with the following arguments:</p>
<ul>
<li>a message string to set in middle of page</li>
<li>a boolean to indicate if true, that the message is drawn in a Ledger style (with corners)</li>
<li>a quit callback, called when quit timer times out (or the page is "tapped")</li>
</ul>
<p>If it's a success status, a "success" tune will be automatically played.</p>
<h2><a class="anchor" id="use_case_review_status"></a>
Pre-defined status Use Case</h2>
<p><img src="UseCase-Review-Status.png" alt="" height="300" class="inline" title="caption"/></p>
<p>Similar as <a class="el" href="nbgl_app_use_case.html#use_case_status">Status Use Case</a>, this is used to display transient page, without control, during a short time, for example when a transaction is successfully signed. The <a class="el" href="nbgl__use__case_8h.html#ae32d39392a88d6aa2595b0d45661f0ab">nbgl_useCaseReviewStatus()</a> function enables to create such a page, with the following arguments:</p>
<ul>
<li>a type of status (with predefined message)</li>
<li>a quit callback, called when quit timer times out (or the page is "tapped")</li>
</ul>
<p>If it's a success status, a "success" tune will be automatically played.</p>
<h2><a class="anchor" id="use_case_review"></a>
Review Use Case</h2>
<p><img src="UseCase-Review.png" alt="" height="300" class="inline" title="caption"/></p>
<p>In most cases, the developer may know all tag/value pairs of a transaction when it is submitted.</p>
<p>In this case, what we call a "static" review can be used. The number of pages is computed automatically and pages can be navigated forward and backward.</p>
<p>In case of a tag/value pair too long to be fully displayed, the "more" button will be automatically drawn and its handling automatically performed by NBGL by building a detailed modal view.</p>
<p>When the user taps on "Reject" in any page, a confirmation page is automatically drawned to let user confirm that he rejects the transaction. In this case, the given callback is called and it's up to app's developer to call <a class="el" href="nbgl__use__case_8h.html#ae32d39392a88d6aa2595b0d45661f0ab">nbgl_useCaseReviewStatus()</a>, as in case of long-press.</p>
<p>The API to initiate the display of the series of pages is <a class="el" href="nbgl__use__case_8h.html#a303e3242b26535f74695f94a51d8cb6a">nbgl_useCaseReview()</a>, providing:</p>
<ul>
<li>the type of operation to review (transaction, message or generic operation)</li>
<li>the list of tag/value pairs (or a callback to get them one by one)</li>
<li>the texts/icon to use in presentation page and in last page</li>
<li>a callback called when the long press button on last page or reject confirmation is used. The callback's param is <em>true</em> for confirmation, <em>false</em> for rejection.</li>
</ul>
<p>Here is the code to display something similar to example picture:</p>
<div class="fragment"><div class="line"><span class="comment">// 4 pairs of tag/value to display</span></div>
<div class="line"><span class="keyword">static</span> <a class="code hl_struct" href="structnbgl__contentTagValue__t.html">nbgl_layoutTagValue_t</a> pairs[4];</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <a class="code hl_struct" href="structnbgl__contentTagValueList__t.html">nbgl_contentTagValueList_t</a> pairList = {</div>
<div class="line">  .<a class="code hl_variable" href="structnbgl__contentTagValueList__t.html#af7465bb412cd1d9fd14bc526d0ea77d8">nbMaxLinesForValue</a> = 0,</div>
<div class="line">  .nbPairs = 4,</div>
<div class="line">  .pairs = (<a class="code hl_struct" href="structnbgl__contentTagValue__t.html">nbgl_layoutTagValue_t</a>*)pairs</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// called when long press button on 3rd page is long-touched or when reject footer is touched</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> onReviewResult(<span class="keywordtype">bool</span> confirm) {</div>
<div class="line">  <span class="comment">// display a status page and go back to main</span></div>
<div class="line">  <span class="keywordflow">if</span> (confirm) {</div>
<div class="line">    <a class="code hl_function" href="nbgl__use__case_8h.html#ae32d39392a88d6aa2595b0d45661f0ab">nbgl_useCaseReviewStatus</a>(<a class="code hl_enumvalue" href="nbgl__use__case_8h.html#aecc6f4750a49ca97c084e3fd5600d5dea699644fad9f83e97303c7422daca9e41">STATUS_TYPE_TRANSACTION_SIGNED</a>, appMain);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> {</div>
<div class="line">    <a class="code hl_function" href="nbgl__use__case_8h.html#ae32d39392a88d6aa2595b0d45661f0ab">nbgl_useCaseReviewStatus</a>(<a class="code hl_enumvalue" href="nbgl__use__case_8h.html#aecc6f4750a49ca97c084e3fd5600d5dea39c63169fc1f2c1a4922cfd0b07bcf0a">STATUS_TYPE_TRANSACTION_REJECTED</a>, appMain);</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> staticReview(<span class="keywordtype">void</span>) {</div>
<div class="line">  <span class="comment">// static review, providing the whole list of pairs</span></div>
<div class="line">  <a class="code hl_function" href="nbgl__use__case_8h.html#a303e3242b26535f74695f94a51d8cb6a">nbgl_useCaseReview</a>(<a class="code hl_enumvalue" href="nbgl__use__case_8h.html#afa09e6097a8248ecbdc81d2fb1bfc317a58ebdf125d0fe120e74ebe9e00f86205">TYPE_TRANSACTION</a>, <span class="comment">// type of operation</span></div>
<div class="line">                      &amp;pairList,       <span class="comment">// list of tag/value pairs</span></div>
<div class="line">                      coinIcon,        <span class="comment">// icon of the coin</span></div>
<div class="line">                      <span class="stringliteral">&quot;Review transaction\nto send coin&quot;</span>, <span class="comment">// title of the first page</span></div>
<div class="line">                      NULL,                               <span class="comment">// sub-title of the first page</span></div>
<div class="line">                      <span class="stringliteral">&quot;Sign transaction to\nsend coin?&quot;</span>,  <span class="comment">// title of the last page</span></div>
<div class="line">                      onReviewResult);                    <span class="comment">// callback on result of the review</span></div>
<div class="line">}</div>
<div class="ttc" id="anbgl__use__case_8h_html_a303e3242b26535f74695f94a51d8cb6a"><div class="ttname"><a href="nbgl__use__case_8h.html#a303e3242b26535f74695f94a51d8cb6a">nbgl_useCaseReview</a></div><div class="ttdeci">void nbgl_useCaseReview(nbgl_operationType_t operationType, const nbgl_contentTagValueList_t *tagValueList, const nbgl_icon_details_t *icon, const char *reviewTitle, const char *reviewSubTitle, const char *finishTitle, nbgl_choiceCallback_t choiceCallback)</div></div>
<div class="ttc" id="anbgl__use__case_8h_html_ae32d39392a88d6aa2595b0d45661f0ab"><div class="ttname"><a href="nbgl__use__case_8h.html#ae32d39392a88d6aa2595b0d45661f0ab">nbgl_useCaseReviewStatus</a></div><div class="ttdeci">void nbgl_useCaseReviewStatus(nbgl_reviewStatusType_t reviewStatusType, nbgl_callback_t quitCallback)</div></div>
<div class="ttc" id="anbgl__use__case_8h_html_aecc6f4750a49ca97c084e3fd5600d5dea39c63169fc1f2c1a4922cfd0b07bcf0a"><div class="ttname"><a href="nbgl__use__case_8h.html#aecc6f4750a49ca97c084e3fd5600d5dea39c63169fc1f2c1a4922cfd0b07bcf0a">STATUS_TYPE_TRANSACTION_REJECTED</a></div><div class="ttdeci">@ STATUS_TYPE_TRANSACTION_REJECTED</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__use__case_8h_source.html#l00230">nbgl_use_case.h:230</a></div></div>
<div class="ttc" id="anbgl__use__case_8h_html_aecc6f4750a49ca97c084e3fd5600d5dea699644fad9f83e97303c7422daca9e41"><div class="ttname"><a href="nbgl__use__case_8h.html#aecc6f4750a49ca97c084e3fd5600d5dea699644fad9f83e97303c7422daca9e41">STATUS_TYPE_TRANSACTION_SIGNED</a></div><div class="ttdeci">@ STATUS_TYPE_TRANSACTION_SIGNED</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__use__case_8h_source.html#l00229">nbgl_use_case.h:229</a></div></div>
<div class="ttc" id="anbgl__use__case_8h_html_afa09e6097a8248ecbdc81d2fb1bfc317a58ebdf125d0fe120e74ebe9e00f86205"><div class="ttname"><a href="nbgl__use__case_8h.html#afa09e6097a8248ecbdc81d2fb1bfc317a58ebdf125d0fe120e74ebe9e00f86205">TYPE_TRANSACTION</a></div><div class="ttdeci">@ TYPE_TRANSACTION</div><div class="ttdoc">For operations transferring a coin or taken from an account to another.</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__use__case_8h_source.html#l00197">nbgl_use_case.h:196</a></div></div>
<div class="ttc" id="astructnbgl__contentTagValueList__t_html"><div class="ttname"><a href="structnbgl__contentTagValueList__t.html">nbgl_contentTagValueList_t</a></div><div class="ttdoc">This structure contains a list of [tag,value] pairs.</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__content_8h_source.html#l00185">nbgl_content.h:185</a></div></div>
<div class="ttc" id="astructnbgl__contentTagValueList__t_html_af7465bb412cd1d9fd14bc526d0ea77d8"><div class="ttname"><a href="structnbgl__contentTagValueList__t.html#af7465bb412cd1d9fd14bc526d0ea77d8">nbgl_contentTagValueList_t::nbMaxLinesForValue</a></div><div class="ttdeci">uint8_t nbMaxLinesForValue</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__content_8h_source.html#l00192">nbgl_content.h:192</a></div></div>
<div class="ttc" id="astructnbgl__contentTagValue__t_html"><div class="ttname"><a href="structnbgl__contentTagValue__t.html">nbgl_contentTagValue_t</a></div><div class="ttdoc">This structure contains a [tag,value] pair.</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__content_8h_source.html#l00148">nbgl_content.h:148</a></div></div>
</div><!-- fragment --><p>Here is another version of the example code, using a callback mechanism to get tag/value pairs:</p>
<div class="fragment"><div class="line"><span class="comment">// common tag/value pair to return</span></div>
<div class="line"><span class="keyword">static</span> <a class="code hl_struct" href="structnbgl__contentTagValue__t.html">nbgl_layoutTagValue_t</a> pair;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <a class="code hl_struct" href="structnbgl__contentTagValue__t.html">nbgl_layoutTagValue_t</a>* getPair(<a class="code hl_typedef" href="usbd__conf_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> index);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <a class="code hl_struct" href="structnbgl__contentTagValueList__t.html">nbgl_contentTagValueList_t</a> pairList = {</div>
<div class="line">  .<a class="code hl_variable" href="structnbgl__contentTagValueList__t.html#af7465bb412cd1d9fd14bc526d0ea77d8">nbMaxLinesForValue</a> = 0,</div>
<div class="line">  .nbPairs = 4,</div>
<div class="line">  .pairs = NULL, <span class="comment">// to indicate that callback should be used</span></div>
<div class="line">  .callback = getPair,</div>
<div class="line">  .startIndex = 0</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// called when long press button on 3rd page is long-touched or when reject footer is touched</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> onReviewResult(<span class="keywordtype">bool</span> confirm) {</div>
<div class="line">  <span class="comment">// display a status page and go back to main</span></div>
<div class="line">  <span class="keywordflow">if</span> (confirm) {</div>
<div class="line">    <a class="code hl_function" href="nbgl__use__case_8h.html#ae32d39392a88d6aa2595b0d45661f0ab">nbgl_useCaseReviewStatus</a>(<a class="code hl_enumvalue" href="nbgl__use__case_8h.html#aecc6f4750a49ca97c084e3fd5600d5dea699644fad9f83e97303c7422daca9e41">STATUS_TYPE_TRANSACTION_SIGNED</a>, appMain);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> {</div>
<div class="line">    <a class="code hl_function" href="nbgl__use__case_8h.html#ae32d39392a88d6aa2595b0d45661f0ab">nbgl_useCaseReviewStatus</a>(<a class="code hl_enumvalue" href="nbgl__use__case_8h.html#aecc6f4750a49ca97c084e3fd5600d5dea39c63169fc1f2c1a4922cfd0b07bcf0a">STATUS_TYPE_TRANSACTION_REJECTED</a>, appMain);</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// function called by NBGL to get the pair indexed by &quot;index&quot;</span></div>
<div class="line"><span class="keyword">static</span> <a class="code hl_struct" href="structnbgl__contentTagValue__t.html">nbgl_layoutTagValue_t</a>* getPair(<a class="code hl_typedef" href="usbd__conf_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> index) {</div>
<div class="line">  <span class="keywordflow">switch</span> (index) {</div>
<div class="line">  <span class="keywordflow">case</span> 0:</div>
<div class="line">    pair.<a class="code hl_variable" href="structnbgl__contentTagValue__t.html#ae8394cc87634df5504b7a224efeb48e2">item</a> = <span class="stringliteral">&quot;To&quot;</span>;</div>
<div class="line">    pair.<a class="code hl_variable" href="structnbgl__contentTagValue__t.html#ac54d64394fafb3edc3f5c751214e3a50">value</a> = <span class="stringliteral">&quot;0x123456&quot;</span>;</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span> 1:</div>
<div class="line">    pair.<a class="code hl_variable" href="structnbgl__contentTagValue__t.html#ae8394cc87634df5504b7a224efeb48e2">item</a> = <span class="stringliteral">&quot;From&quot;</span>;</div>
<div class="line">    pair.<a class="code hl_variable" href="structnbgl__contentTagValue__t.html#ac54d64394fafb3edc3f5c751214e3a50">value</a> = <span class="stringliteral">&quot;0x654321&quot;</span>;</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span> 2:</div>
<div class="line">    pair.<a class="code hl_variable" href="structnbgl__contentTagValue__t.html#ae8394cc87634df5504b7a224efeb48e2">item</a> = <span class="stringliteral">&quot;Amount&quot;</span>;</div>
<div class="line">    pair.<a class="code hl_variable" href="structnbgl__contentTagValue__t.html#ac54d64394fafb3edc3f5c751214e3a50">value</a> = <span class="stringliteral">&quot;1.2345 BTC&quot;</span>;</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span> 3:</div>
<div class="line">    pair.<a class="code hl_variable" href="structnbgl__contentTagValue__t.html#ae8394cc87634df5504b7a224efeb48e2">item</a> = <span class="stringliteral">&quot;Fees&quot;</span>;</div>
<div class="line">    pair.<a class="code hl_variable" href="structnbgl__contentTagValue__t.html#ac54d64394fafb3edc3f5c751214e3a50">value</a> = <span class="stringliteral">&quot;0.1 BTC&quot;</span>;</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> &amp;pair;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> staticReview(<span class="keywordtype">void</span>) {</div>
<div class="line">  <span class="comment">// static review, providing the whole list of pairs</span></div>
<div class="line">  <a class="code hl_function" href="nbgl__use__case_8h.html#a303e3242b26535f74695f94a51d8cb6a">nbgl_useCaseReview</a>(<a class="code hl_enumvalue" href="nbgl__use__case_8h.html#afa09e6097a8248ecbdc81d2fb1bfc317a58ebdf125d0fe120e74ebe9e00f86205">TYPE_TRANSACTION</a>, <span class="comment">// type of operation</span></div>
<div class="line">                      &amp;pairList,       <span class="comment">// list of tag/value pairs</span></div>
<div class="line">                      coinIcon,        <span class="comment">// icon of the coin</span></div>
<div class="line">                      <span class="stringliteral">&quot;Review transaction\nto send coin&quot;</span>, <span class="comment">// title of the first page</span></div>
<div class="line">                      NULL,                               <span class="comment">// sub-title of the first page</span></div>
<div class="line">                      <span class="stringliteral">&quot;Sign transaction to\nsend coin?&quot;</span>,  <span class="comment">// title of the last page</span></div>
<div class="line">                      onReviewResult);                    <span class="comment">// callback on result of the review</span></div>
<div class="line">}</div>
<div class="ttc" id="astructnbgl__contentTagValue__t_html_ac54d64394fafb3edc3f5c751214e3a50"><div class="ttname"><a href="structnbgl__contentTagValue__t.html#ac54d64394fafb3edc3f5c751214e3a50">nbgl_contentTagValue_t::value</a></div><div class="ttdeci">const char * value</div><div class="ttdoc">string giving the value name</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__content_8h_source.html#l00150">nbgl_content.h:150</a></div></div>
<div class="ttc" id="astructnbgl__contentTagValue__t_html_ae8394cc87634df5504b7a224efeb48e2"><div class="ttname"><a href="structnbgl__contentTagValue__t.html#ae8394cc87634df5504b7a224efeb48e2">nbgl_contentTagValue_t::item</a></div><div class="ttdeci">const char * item</div><div class="ttdoc">string giving the tag name</div><div class="ttdef"><b>Definition:</b> <a href="nbgl__content_8h_source.html#l00149">nbgl_content.h:149</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="use_case_review_light"></a>
Light review Use Case</h2>
<p>In some cases, the developer may want to display a review but with a less intense confirmation than a long-press button. A simple button is used in this case.</p>
<p>The API to initiate the display of the series of pages is <a class="el" href="nbgl__use__case_8h.html#adb0805a5c32e8515c0e36ecd856f1a40">nbgl_useCaseReviewLight()</a>, providing:</p>
<ul>
<li>the list of tag/value pairs (or a callback to get them one by one)</li>
<li>the texts/icon to use in presentation page and in last page</li>
<li>a callback called when the long press button on last page or reject confirmation is used. The callback's param is <em>true</em> for confirmation, <em>false</em> for rejection.</li>
</ul>
<h2><a class="anchor" id="use_case_review_streaming"></a>
Streaming review Use Case</h2>
<p><img src="UseCase-Streaming.png" alt="" height="300" class="inline" title="caption"/></p>
<p>In some cases, the application cannot know all tag/value pairs of a transaction when the review is started.</p>
<p>In this case, what we call a "streaming" review can be used. The pages to display for each "stream are computed automatically and pages can be navigated forward
and backward (only within a "stream" for backward).

In case of a tag/value pair too long to be fully displayed, the "more" button will be automatically drawn and its handling
automatically performed by NBGL by building a detailed modal view.

When the user taps on "Reject" in any page, a confirmation page is automatically drawned to let user confirm that he rejects
the transaction. In this case, the given callback is called and it's up to app's developer to call @ref nbgl_useCaseReviewStatus(), as in
case of long-press.

The API to initiate the display of the series of pages is @ref nbgl_useCaseReviewStreamingStart(), providing:

- the type of operation to review (transaction, message or generic operation)
- the texts/icon to use in presentation page
- a callback with one boolean parameter.
  - If this parameter is &lt;em&gt;false&lt;/em&gt;, it means that the transaction is rejected.
  - If this parameter is &lt;em&gt;true&lt;/em&gt;, it means that NBGL is waiting for new data, sent with @ref nbgl_useCaseReviewStreamingContinue() or @ref nbgl_useCaseReviewStreamingContinueExt()

As long as there are new tag/value pairs to send, the API to call is either @ref nbgl_useCaseReviewStreamingContinueExt() (if skip is possible) or
@ref nbgl_useCaseReviewStreamingContinue(), providing:

- the list of tag/value pairs (or a callback to get them one by one)
- a callback with one boolean parameter.
  - If this parameter is &lt;em&gt;false&lt;/em&gt;, it means that the transaction is rejected.
  - If this parameter is &lt;em&gt;true&lt;/em&gt;, it means that NBGL is waiting for new data, to be sent with @ref nbgl_useCaseReviewStreamingContinue() or @ref nbgl_useCaseReviewStreamingContinueExt()

When there is no more data to senf, the API to call is either @ref nbgl_useCaseReviewStreamingFinish(), providing:

- the title to use for last page (with long-press button)
- a callback called when the long press button on last page or reject confirmation is used. The callback's param is &lt;em&gt;true&lt;/em&gt; for confirmation, &lt;em&gt;false&lt;/em&gt; for rejection.

Here is the code to display something similar to example picture:

@code 

// called when long press button on last page is long-touched or when reject footer is touched
static void onReviewResult(bool confirm) {
  // display a status page and go back to main
  if (confirm) {
    nbgl_useCaseReviewStatus(STATUS_TYPE_TRANSACTION_SIGNED, appMain);
  }
  else {
    nbgl_useCaseReviewStatus(STATUS_TYPE_TRANSACTION_REJECTED, appMain);
  }
}

static void onTransactionContinue(bool askMore)
{
  if (askMore) {
    nbgl_contentTagValueList_t pairsToSend;
    // try to get more data
    if (moreDataToSend(&amp;pairsToSend)) {
      nbgl_useCaseReviewStreamingContinue(&amp;pairsToSend, onTransactionContinue);
    }
    else {
      // all data sent, so finish
      nbgl_useCaseReviewStreamingFinish("Sign transaction to transfer Cardano?", // title on last page
                                        onReviewResult); // callback to handle reject/accept
    }
  }
  else {
      onReviewResult(false);
  }
}

void staticReview(void) {
  // initiate the streaming review
  nbgl_useCaseReviewStreamingStart(TYPE_TRANSACTION,
                                    &amp;C_ic_asset_cardano_64, // icon on first and last page
                                    "Review transaction",   // title of the first page
                                    NULL,                   // sub-title of the first page
                                    onTransactionContinue); // callback to reject or ask more data
}
@endcode

@subsection use_case_addr_review Address Review Use Case

@image{inline} html UseCase-AddressReview.png "caption" height=500

When an address needs to be confirmed, it can be displayed in a Address Review Use Case.
After a title page, a second page is displayed with the raw address (as text). An extra button under the raw address enables to open a modal page to see the address as a QR code.
Moreover, if extra information need to be displayed, for example a derivation path, it is provided in a second page, also containing
a black button/Footer pair to choose to confirm or reject the address.

The @ref nbgl_useCaseAddressReview() function enables to create such a set of pages, with the following parameters:

- the address to confirm (NULL terminated string)
- a callback called when button or footer is touched (if true, confirm, if false reject)
- the list of extra tag/value pairs

Here is the code to display something similar to example picture:

@code 
// 2 pairs of tag/value to display in second page
static nbgl_layoutTagValue_t pairs[2];

static const nbgl_contentTagValueList_t pairList = {
  .nbMaxLinesForValue = 0,
  .nbPairs = 2,
  .pairs = (nbgl_layoutTagValue_t*)pairs
};

// called when either confirm button or reject token is called
static void displayAddressCallback(bool confirm) {
  if (confirm) {
    nbgl_useCaseStatus("ADDRESS\nVERIFIED",true,app_fullEthereum);
  }
  else {
    nbgl_useCaseStatus("Address rejected",false,app_fullEthereum);
  }
}

void app_ethereumVerifyAddress(void) {
  nbgl_useCaseAddressReview("bc1pkdcufjh6dxjaaa05hudvxqg5fhspfmwmp8g92gq8cv4gwwnmgrfqfd4jlg",
                            &amp;pairList
                            myAppIcon,
                            "Verify MyCoin\naddress",
                            NULL,"Cancel",
                            appMain);
}
@endcode

@subsection use_case_spinner Spinner Use Case

@image{inline} html UseCase-Spinner.png "caption" height=300

When an address needs to be confirmed, it can be displayed in a Address Confirmation Use Case, at first as simple page with
the raw address (as text) and a black button/Footer pair to choose to confirm or reject the address.

An extra button under the raw address enables to open a modal page to see the address as a QR code.

The @ref nbgl_useCaseSpinner() function enables to create such a page, with the following parameters:

@subsection use_case_keypad Keypad Use Case

@image{inline} html UseCase-Keypad.png "caption" height=350

We have here 2 different variants, allowing to show or hide the entered digits.

When a pincode is requested, a default keypad can be displayed, with hidden digits.
As shown on the image above, it consists of:

- a navigation bar at the top
- a title area, specifying the type of pin code or operation requested
- a hidden Digits area (the max nb of supported digits is 12)
- the keypad at the bottom

The @ref nbgl_useCaseKeypadPIN() function enables to create such page, with the following parameters:

- the title
- min and max pin code lengths
- a token for the navigation callback (if not provided, no navigation bar will appear)
- a boolean to request a shuffled keypad
- a tune value
- callbacks for navigation and pin validation

The other variant, where digits don't need to be hidden is @ref nbgl_useCaseKeypadDigits();
it takes the same parameters.

@note The \em backspace and \em validate buttons will be shown or hidden automatically.

Here is the code to display something similar to example picture:

@code 
static void validate_pin(const uint8_t *pinentry, uint8_t length) {
    // Code to validate the entered pin code
}

static void pinentry_cb(int token, uint8_t index) {
    UNUSED(index);
    // Callback for the key navigation (back key mainly)
    if (token == TOKEN_PIN_ENTRY_BACK) {
        ui_init();
    }
}

void ui_menu_pinentry_display(unsigned int value) {
    // Draw the keypad
    nbgl_useCaseKeypadPIN("Enter User PIN", 6, 12, TOKEN_PIN_ENTRY_BACK, false, TUNE_TAP_CASUAL, validate_pin, pinentry_cb); } </p>
<h1><a class="anchor" id="use_case_refresh_page"></a>
Refreshing screen</h1>
<p>After having drawn graphic objects in <b>framebuffer</b>, all functions of this API automatically refresh the screen. So no need to call <a class="el" href="nbgl__obj_8h.html#a2c321e01f64784c5249e594b795bf252">nbgl_refresh()</a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
